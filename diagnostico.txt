=== DIAGNOSTIC REPORT START ===

> naroa-2026@2.0.0 build
> vite build

vite v5.4.21 building for production...
transforming...
‚úì 130 modules transformed.
rendering chunks...
computing gzip size...
dist/index.html                                   37.17 kB ‚îÇ gzip:  8.79 kB
dist/assets/favicon-Inu7iesc.png                  45.21 kB
dist/assets/la-pensadora-CFHSnMA0.webp           148.58 kB
dist/assets/geisha-MfRtKWdu.webp                 163.12 kB
dist/assets/dar-la-lata-DxWlKgS-.webp            166.10 kB
dist/assets/audrey-hepburn-DbIBTtIp.webp         235.11 kB
dist/assets/pajarraca-azul-Bl-shQZq.webp         241.82 kB
dist/assets/cantinflas-0-D712oJYO.webp           243.86 kB
dist/assets/baroque-farrokh-mjg4ClA9.webp        245.09 kB
dist/assets/naroa-portrait-DW8XfHYG.jpg          265.76 kB
dist/assets/el-gran-dakari-C1tAWAhR.webp         301.39 kB
dist/assets/mr-fahrenheit-BzcoVisa.webp          303.94 kB
dist/assets/lagrimas-de-oro-DikHc-Tk.webp        316.82 kB
dist/assets/amor-en-conserva-CMHRIKXx.webp       358.91 kB
dist/assets/love-DA7L_L5F.webp                   379.51 kB
dist/assets/hq-amy-DBhvo6_w.webp                 528.99 kB
dist/assets/hq-johnny-D5n9ooU5.webp              587.64 kB
dist/assets/hq-james-CemWySYv.webp               595.50 kB
dist/assets/marilyn-rocks-hq-5-l9WT7uew.webp     789.53 kB
dist/assets/hq-portrait-1-Bm6vbtMb.webp        1,194.89 kB
dist/assets/incredible-crisis-DGq5NbYt.css         4.31 kB ‚îÇ gzip:  1.33 kB
dist/assets/tetris-game-DmwdeU2q.css               5.50 kB ‚îÇ gzip:  1.63 kB
dist/assets/games-hub-D55DcPz9.css                 5.74 kB ‚îÇ gzip:  1.66 kB
dist/assets/arcade-leaderboard-BYDICsvk.css        6.09 kB ‚îÇ gzip:  1.67 kB
dist/assets/oca-game-DjuLga6a.css                  9.21 kB ‚îÇ gzip:  2.48 kB
dist/assets/restaurador-game-CHkpuEit.css         10.73 kB ‚îÇ gzip:  2.55 kB
dist/assets/main-PdlnDe9U.css                    114.61 kB ‚îÇ gzip: 23.27 kB
dist/assets/scroll-BDnknv8y.js                     0.55 kB ‚îÇ gzip:  0.35 kB
dist/assets/games-D4jEc6K0.js                      1.40 kB ‚îÇ gzip:  0.72 kB
dist/assets/cursor-CWaDe2P0.js                     2.20 kB ‚îÇ gzip:  0.91 kB
dist/assets/liquid-distortion-BiSUU0OZ.js          6.06 kB ‚îÇ gzip:  2.13 kB
dist/assets/gallery-DRYR8jQt.js                    9.83 kB ‚îÇ gzip:  3.60 kB
dist/assets/videocall-panel-BbzX-lmx.js           12.59 kB ‚îÇ gzip:  3.23 kB
dist/assets/exposiciones-timeline-CNf1qIOF.js     13.38 kB ‚îÇ gzip:  4.42 kB
dist/assets/main-BywW5dSj.js                      37.24 kB ‚îÇ gzip: 11.86 kB
dist/assets/vendor-7OteaNBb.js                   188.00 kB ‚îÇ gzip: 65.38 kB
‚úì built in 680ms
=== LOC ===
     381 ./dist/js/parallax-shader.js
     231 ./dist/js/mica-naroa-nlp.js
     462 ./dist/js/liquid-transition.js
     161 ./dist/js/mica-typewriter.js
     257 ./dist/js/mica-interactions.js
      54 ./dist/js/core/scroller.js
      50 ./dist/js/core/scroll.js
     311 ./dist/js/core/arcade-leaderboard.js
     364 ./dist/js/core/mica-memory.js
     221 ./dist/js/core/mica-orchestrator.js
      55 ./dist/js/core/config.js
     300 ./dist/js/core/mica-swarm.js
     253 ./dist/js/core/router.js
     117 ./dist/js/core/cursor.js
     286 ./dist/js/core/swarm-orchestrator.js
      54 ./dist/js/core/transitions.js
     318 ./dist/js/core/wow-effects-2026.js
      54 ./dist/js/core/enhancements.js
     189 ./dist/js/core/ranking-system.js
     163 ./dist/js/core/soty-effects.js
     575 ./dist/js/core/mica-crisis-engine.js
     143 ./dist/js/core/mica-brain.js
     319 ./dist/js/spanish-calendar-context.js
    1027 ./dist/js/incredible-crisis-games.js
     163 ./dist/js/mica-unified.js
     403 ./dist/js/naroa-cursor-variants.js
     403 ./dist/js/mica-particles-webgl.js
     349 ./dist/js/features/infinite-hero.js
     198 ./dist/js/features/breakout-game.js
     170 ./dist/js/features/mica-organic-sphere.js
     117 ./dist/js/features/video-transitions.js
      44 ./dist/js/features/scroll-to-top.js
     112 ./dist/js/features/discovery-tracker.js
     112 ./dist/js/features/reinas-game.js
      84 ./dist/js/features/cantinflas-clones.js
     145 ./dist/js/features/snake-game.js
      99 ./dist/js/features/whack-game.js
     129 ./dist/js/features/kintsugi-game.js
      92 ./dist/js/features/catch-game.js
     133 ./dist/js/features/seo-manager.js
     479 ./dist/js/features/exposiciones-timeline.js
     293 ./dist/js/features/infinite-canvas-360.js
     207 ./dist/js/features/oca-game.js
     280 ./dist/js/features/gallery-chaos.js
     171 ./dist/js/features/mica-heart.js
      70 ./dist/js/features/restaurador-game.js
     586 ./dist/js/features/gallery.js
      56 ./dist/js/features/typing-game.js
      88 ./dist/js/features/pong-game.js
     196 ./dist/js/features/progressive-hero.js
     545 ./dist/js/features/game-gateway.js
      97 ./dist/js/features/mica-game.js
     102 ./dist/js/features/navigation.js
     336 ./dist/js/features/deep-zoom.js
      76 ./dist/js/features/continuous-loop.js
      95 ./dist/js/features/cinematic-grain.js
      65 ./dist/js/features/arcade-games.js
      87 ./dist/js/features/video-showcase.js
     486 ./dist/js/features/lightbox.js
     277 ./dist/js/features/intro.js
     410 ./dist/js/features/restaurador-web3.js
     164 ./dist/js/features/soul-console.js
     104 ./dist/js/features/simon-game.js
      64 ./dist/js/features/reaction-game.js
     192 ./dist/js/features/blog-engine.js
     122 ./dist/js/features/stitch-lab.js
      48 ./dist/js/features/strategy-games.js
    1139 ./dist/js/features/gallery-disruptive.js
     321 ./dist/js/features/notch-island.js
      64 ./dist/js/features/artwork-loader.js
     370 ./dist/js/features/artwork-detail.js
     153 ./dist/js/features/golden-ratio.js
     420 ./dist/js/features/mica-dashboard.js
     147 ./dist/js/features/kimi-ideas.js
     214 ./dist/js/features/tetris-game.js
      67 ./dist/js/features/rocks-showcase.js
     441 ./dist/js/features/videocall-panel.js
      68 ./dist/js/features/quiz-game.js
     126 ./dist/js/features/puzzle-game.js
     138 ./dist/js/features/collage-game.js
     118 ./dist/js/features/memory-game.js
     996 ./dist/js/webgl/liquid-transition.js
     626 ./dist/js/webgl/parallax-depth.js
     381 ./dist/js/webgl/scroll-shader.js
     221 ./dist/js/webgl/film-grain.js
     265 ./dist/js/webgl/noise-background.js
       0 ./dist/js/webgl/noise-bg-clean.js
     145 ./dist/js/webgl/effects-manager.js
      60 ./dist/js/spotify-rotator.js
     226 ./dist/js/mica-avatar-3d.js
     149 ./dist/js/components/artwork-gallery-api.js
     210 ./dist/js/mica-media-engine.js
      96 ./dist/js/audio/audio-visual-sync.js
     281 ./dist/js/audio/audio-hooks.js
     556 ./dist/js/audio/audio-synth.js
     442 ./dist/js/audio/immersive-audio.js
     205 ./dist/js/api/client.js
     124 ./dist/js/api/cache.js
     274 ./dist/js/api/useInfiniteArtworks.js
      33 ./dist/js/api/index.js
     210 ./dist/js/api/artworks.js
      93 ./dist/js/api/retry.js
     318 ./dist/js/mica-emotion-engine.js
     178 ./dist/js/mica-video-engine.js
     114 ./dist/js/game-asset-manager.js
     157 ./dist/js/sistema-21-juegos.js
     197 ./dist/js/systems/charcoal-shader.js
      99 ./dist/js/systems/paper-parallax.js
     127 ./dist/js/systems/mica-reactive.js
      94 ./dist/js/systems/noir-init.js
     149 ./dist/js/systems/pigment-trail.js
      64 ./dist/js/effects/bandcamp-radio.js
     347 ./dist/js/effects/displacement-depth-parallax.js
     263 ./dist/js/effects/games-premium.js
      98 ./dist/js/effects/hero-animations.js
     343 ./dist/js/effects/audio-reactive.js
     236 ./dist/js/effects/liquid-distortion.js
     606 ./dist/js/effects/wow-10-stars.js
      38 ./dist/js/effects/magnet.js
     142 ./dist/js/effects/eyes-follow.js
     292 ./dist/js/effects/scroll-360.js
     198 ./dist/js/effects/clima-palette.js
     132 ./dist/js/effects/cursor-sfx.js
      68 ./dist/js/effects/cursor-spotlight.js
      86 ./dist/js/effects/organic-particles.js
     173 ./dist/js/effects/cursor-trail.js
      69 ./dist/js/effects/ui-sounds.js
     120 ./dist/js/effects/hero-phrases.js
     174 ./dist/js/effects/kinetic-text.js
     135 ./dist/js/effects/palindrome-hero.js
     308 ./dist/js/effects/musica-concreta.js
     241 ./dist/js/effects/parallax-3d-depth.js
     119 ./dist/js/effects/reveal-observer.js
     125 ./dist/js/effects/hero-parallax.js
     109 ./dist/js/effects/magnetic-button.js
      42 ./dist/js/effects/hero-slider.js
     158 ./dist/js/effects/wave-background.js
     119 ./dist/js/effects/wow-effects.js
     169 ./dist/js/mica-cursor.js
     179 ./dist/js/services/exposiciones-data-service.js
     126 ./dist/js/services/data-cache.js
     100 ./dist/js/services/observability-service.js
      80 ./dist/js/services/image-loader.js
     141 ./dist/js/services/stitch-service.js
     367 ./dist/js/services/k25-vision-service.js
      79 ./dist/assets/liquid-distortion-BiSUU0OZ.js
       1 ./dist/assets/scroll-BDnknv8y.js
       1 ./dist/assets/cursor-CWaDe2P0.js
     165 ./dist/assets/videocall-panel-BbzX-lmx.js
      35 ./dist/assets/vendor-7OteaNBb.js
      12 ./dist/assets/games-D4jEc6K0.js
      45 ./dist/assets/gallery-DRYR8jQt.js
     150 ./dist/assets/exposiciones-timeline-CNf1qIOF.js
     126 ./dist/assets/main-BywW5dSj.js
     381 ./js/parallax-shader.js
     231 ./js/mica-naroa-nlp.js
     462 ./js/liquid-transition.js
     161 ./js/mica-typewriter.js
     257 ./js/mica-interactions.js
      54 ./js/core/scroller.js
      50 ./js/core/scroll.js
     311 ./js/core/arcade-leaderboard.js
     364 ./js/core/mica-memory.js
     221 ./js/core/mica-orchestrator.js
      55 ./js/core/config.js
     300 ./js/core/mica-swarm.js
     253 ./js/core/router.js
     117 ./js/core/cursor.js
     286 ./js/core/swarm-orchestrator.js
      54 ./js/core/transitions.js
     318 ./js/core/wow-effects-2026.js
      54 ./js/core/enhancements.js
     189 ./js/core/ranking-system.js
     163 ./js/core/soty-effects.js
     575 ./js/core/mica-crisis-engine.js
     143 ./js/core/mica-brain.js
     319 ./js/spanish-calendar-context.js
    1027 ./js/incredible-crisis-games.js
     163 ./js/mica-unified.js
     403 ./js/naroa-cursor-variants.js
     403 ./js/mica-particles-webgl.js
     349 ./js/features/infinite-hero.js
     198 ./js/features/breakout-game.js
     170 ./js/features/mica-organic-sphere.js
     117 ./js/features/video-transitions.js
      44 ./js/features/scroll-to-top.js
     112 ./js/features/discovery-tracker.js
     112 ./js/features/reinas-game.js
      84 ./js/features/cantinflas-clones.js
     145 ./js/features/snake-game.js
      99 ./js/features/whack-game.js
     129 ./js/features/kintsugi-game.js
      92 ./js/features/catch-game.js
     133 ./js/features/seo-manager.js
     479 ./js/features/exposiciones-timeline.js
     293 ./js/features/infinite-canvas-360.js
     207 ./js/features/oca-game.js
     280 ./js/features/gallery-chaos.js
     171 ./js/features/mica-heart.js
      70 ./js/features/restaurador-game.js
     586 ./js/features/gallery.js
      56 ./js/features/typing-game.js
      88 ./js/features/pong-game.js
     196 ./js/features/progressive-hero.js
     545 ./js/features/game-gateway.js
      97 ./js/features/mica-game.js
     102 ./js/features/navigation.js
     336 ./js/features/deep-zoom.js
      76 ./js/features/continuous-loop.js
      95 ./js/features/cinematic-grain.js
      65 ./js/features/arcade-games.js
      87 ./js/features/video-showcase.js
     486 ./js/features/lightbox.js
     277 ./js/features/intro.js
     410 ./js/features/restaurador-web3.js
     164 ./js/features/soul-console.js
     104 ./js/features/simon-game.js
      64 ./js/features/reaction-game.js
     192 ./js/features/blog-engine.js
     122 ./js/features/stitch-lab.js
      48 ./js/features/strategy-games.js
    1139 ./js/features/gallery-disruptive.js
     321 ./js/features/notch-island.js
      64 ./js/features/artwork-loader.js
     370 ./js/features/artwork-detail.js
     153 ./js/features/golden-ratio.js
     420 ./js/features/mica-dashboard.js
     147 ./js/features/kimi-ideas.js
     214 ./js/features/tetris-game.js
      67 ./js/features/rocks-showcase.js
     441 ./js/features/videocall-panel.js
      68 ./js/features/quiz-game.js
     126 ./js/features/puzzle-game.js
     138 ./js/features/collage-game.js
     118 ./js/features/memory-game.js
     996 ./js/webgl/liquid-transition.js
     626 ./js/webgl/parallax-depth.js
     381 ./js/webgl/scroll-shader.js
     221 ./js/webgl/film-grain.js
     265 ./js/webgl/noise-background.js
       0 ./js/webgl/noise-bg-clean.js
     145 ./js/webgl/effects-manager.js
      60 ./js/spotify-rotator.js
     226 ./js/mica-avatar-3d.js
     149 ./js/components/artwork-gallery-api.js
     210 ./js/mica-media-engine.js
      96 ./js/audio/audio-visual-sync.js
     281 ./js/audio/audio-hooks.js
     556 ./js/audio/audio-synth.js
     442 ./js/audio/immersive-audio.js
     205 ./js/api/client.js
     124 ./js/api/cache.js
     274 ./js/api/useInfiniteArtworks.js
      33 ./js/api/index.js
     210 ./js/api/artworks.js
      93 ./js/api/retry.js
     318 ./js/mica-emotion-engine.js
     178 ./js/mica-video-engine.js
     114 ./js/game-asset-manager.js
     157 ./js/sistema-21-juegos.js
     197 ./js/systems/charcoal-shader.js
      99 ./js/systems/paper-parallax.js
     127 ./js/systems/mica-reactive.js
      94 ./js/systems/noir-init.js
     149 ./js/systems/pigment-trail.js
      64 ./js/effects/bandcamp-radio.js
     347 ./js/effects/displacement-depth-parallax.js
     263 ./js/effects/games-premium.js
      98 ./js/effects/hero-animations.js
     343 ./js/effects/audio-reactive.js
     236 ./js/effects/liquid-distortion.js
     606 ./js/effects/wow-10-stars.js
      38 ./js/effects/magnet.js
     142 ./js/effects/eyes-follow.js
     292 ./js/effects/scroll-360.js
     198 ./js/effects/clima-palette.js
     132 ./js/effects/cursor-sfx.js
      68 ./js/effects/cursor-spotlight.js
      86 ./js/effects/organic-particles.js
     173 ./js/effects/cursor-trail.js
      69 ./js/effects/ui-sounds.js
     120 ./js/effects/hero-phrases.js
     174 ./js/effects/kinetic-text.js
     135 ./js/effects/palindrome-hero.js
     308 ./js/effects/musica-concreta.js
     241 ./js/effects/parallax-3d-depth.js
     119 ./js/effects/reveal-observer.js
     125 ./js/effects/hero-parallax.js
     109 ./js/effects/magnetic-button.js
      42 ./js/effects/hero-slider.js
     158 ./js/effects/wave-background.js
     119 ./js/effects/wow-effects.js
     169 ./js/mica-cursor.js
     179 ./js/services/exposiciones-data-service.js
     126 ./js/services/data-cache.js
     100 ./js/services/observability-service.js
      80 ./js/services/image-loader.js
     141 ./js/services/stitch-service.js
     367 ./js/services/k25-vision-service.js
     131 ./tests/tetris.test.js
      18 ./tests/app.test.js
      54 ./utils/cloudinary-helper.js
      85 ./vite.config.js
      13 ./mixcraft/dist/assets/index-iPVkFKWZ.js
      14 ./mixcraft/vite.config.js
      78 ./mixcraft/src/ui/components/Transport.js
      67 ./mixcraft/src/ui/components/FXRack.js
     118 ./mixcraft/src/ui/components/Mixer.js
     107 ./mixcraft/src/ui/UIManager.js
     294 ./mixcraft/src/fx/fx-engine.js
     591 ./mixcraft/src/audio/master-chain.js
     415 ./mixcraft/src/audio/audio-engine.js
     101 ./mixcraft/src/audio/sample-engine.js
     120 ./mixcraft/src/audio/waveform-renderer.js
     100 ./mixcraft/src/viz/spectrum-analyzer.js
     270 ./mixcraft/src/viz/visualizer.js
     170 ./mixcraft/src/export/exporter.js
     311 ./mixcraft/src/timeline/timeline.js
     231 ./mixcraft/src/app.js
     200 ./main.js
      26 ./scripts/convert_cursor.js
     174 ./scripts/optimize-assets.js
      61 ./scripts/local-api.js
      62 ./scripts/maintenance/generate-web-images.js
      48 ./scripts/maintenance/optimize-hero.js
     112 ./scripts/ipfs-upload.js
      38 ./api/stitch.js
      92 ./api/chat.js
      42 ./service-worker.js
   67903 total
=== TODOs ===
./MEJORALO_PLAN.md:3. **Todo/Hack**: [ ] Resolver los 7 TODOs detectados de alta prioridad.
./diagnostico.txt:=== TODOs ===
./dist/js/incredible-crisis-games.js:// CLASE BASE PARA TODOS LOS MINIJUEGOS
./dist/js/incredible-crisis-games.js:        <button class="play-all-btn">‚ñ∂Ô∏è JUGAR TODOS</button>
./dist/js/features/restaurador-web3.js:    // TODO: When contract is deployed, add actual minting:
./dist/js/features/blog-engine.js:El **kintsugi** es el arte japon√©s de reparar cer√°mica rota con oro. En lugar de ocultar las grietas, las celebra. Y d√©jame decirte: Naroa aplica esto a TODO.
./dist/js/systems/charcoal-shader.js: * TODO: Implementar WebGL shader con:
./dist/js/systems/charcoal-shader.js:    // TODO: Implementar renderizado WebGL completo
./js/incredible-crisis-games.js:// CLASE BASE PARA TODOS LOS MINIJUEGOS
./js/incredible-crisis-games.js:        <button class="play-all-btn">‚ñ∂Ô∏è JUGAR TODOS</button>
./js/features/restaurador-web3.js:    // TODO: When contract is deployed, add actual minting:
./js/features/blog-engine.js:El **kintsugi** es el arte japon√©s de reparar cer√°mica rota con oro. En lugar de ocultar las grietas, las celebra. Y d√©jame decirte: Naroa aplica esto a TODO.
./js/systems/charcoal-shader.js: * TODO: Implementar WebGL shader con:
./js/systems/charcoal-shader.js:    // TODO: Implementar renderizado WebGL completo
./tests/tetris.test.js:    // We need to see where MicaMinigame is defined. It wasn't in the grep for TODOs.
./.git/hooks/sendemail-validate.sample:# Replace the TODO placeholders with appropriate checks according to your
./.git/hooks/sendemail-validate.sample:	# TODO: Replace with appropriate checks (e.g. spell checking).
./.git/hooks/sendemail-validate.sample:	# TODO: Replace with appropriate checks for this patch
./.git/hooks/sendemail-validate.sample:	# TODO: Replace with appropriate checks for the whole series
./.git/hooks/commit-msg:# 2. Scan staged files for "TODO" (English) instead of "PENDIENTE" (Spanish)
./.git/hooks/commit-msg:# git diff --cached --name-only | xargs grep "TODO:" && echo "‚ö†Ô∏è WARNING: Found 'TODO'. Prefer 'PENDIENTE' for Sovereign Code."
=== FIXMEs ===
./diagnostico.txt:=== FIXMEs ===
=== CONSOLE.LOG ===
./convert_images.cjs:console.log(`Scanning ${publicDir} for images...`);
./convert_images.cjs:console.log(`Found ${files.length} images to process.`);
./convert_images.cjs:            // console.log(`Skipping ${name}, .webp already exists.`);
./convert_images.cjs:            console.log(`‚úÖ Converted: ${name}${ext} -> .webp`);
./convert_images.cjs:    console.log("‚ú® Asset Sovereignty: Image optimization complete.");
./MEJORALO_PLAN.md:- **C√≥digo Muerto**: ‚úÖ console.log = 0 (0)
./MEJORALO_PLAN.md:1. **Dead Code**: [x] Eliminar llamadas a `console.log/debug/warn` en JS.
./dist/assets/main-BywW5dSj.js:    `}}class D{constructor(){this.systems={},this.boot()}async boot(){var e,t;console.groupCollapsed("üåÄ [NEXUS-V‚àû] Establishing Sovereignty");try{this.systems.router=new k,this.systems.rankings=L,this.systems.mica=new S,this.systems.transitions=M,this.setupRouting(),A(),await this.launch("Scroll",()=>m(()=>import("./scroll-BDnknv8y.js"),__vite__mapDeps([0,1]))),await this.launch("Cursor",()=>m(()=>import("./cursor-CWaDe2P0.js"),__vite__mapDeps([2,1]))),(e=this.systems.Scroll)!=null&&e.SmoothScrollSystem&&(this.systems.Scroll=new this.systems.Scroll.SmoothScrollSystem),(t=this.systems.Cursor)!=null&&t.CursorSystem&&(this.systems.Cursor=new this.systems.Cursor.CursorSystem),this.initLegacyModules(),this.ensurePremiumStructuralHarmony(),console.log("‚úÖ [APOTHEOSIS] System Soul active.")}catch(s){console.error("‚ùå [VOID] Critical system failure:",s)}console.groupEnd()}setupRouting(){const e=this.systems.router;e.register("#/",()=>this.systems.transitions.play(()=>window.scrollTo({top:0,behavior:"instant"}))),e.register("#/galeria",()=>this.systems.transitions.play(()=>this.loadFeature("gallery","loadArchive"))),e.register("#/archivo",()=>this.systems.transitions.play(()=>this.loadFeature("gallery","loadArchive"))),e.register("#/contacto",()=>this.systems.transitions.play(()=>this.loadFeature("videocall","init","contacto-container"))),e.register("#/destacada",()=>this.systems.transitions.play(()=>e.showView("view-destacada"))),e.register("#/juegos",()=>this.systems.transitions.play(()=>e.showView("view-juegos"))),e.register("#/juego",()=>this.systems.transitions.play(()=>{e.showView("view-juego"),this.loadFeature("restaurador-game","init")})),e.init(),this.bindNavigation()}async loadFeature(e,t,...s){const i={gallery:()=>m(()=>import("./gallery-DRYR8jQt.js"),[]),videocall:()=>m(()=>import("./videocall-panel-BbzX-lmx.js"),[]),"restaurador-game":()=>m(()=>import("./games-D4jEc6K0.js"),[]),exposiciones:()=>m(()=>import("./exposiciones-timeline-CNf1qIOF.js"),[])};if(i[e]){const o=await i[e](),r=o.default||o[e]||window[e.charAt(0).toUpperCase()+e.slice(1)];r&&r[t]&&r[t](...s)}}bindNavigation(){document.querySelectorAll(".nav__link").forEach(e=>{e.addEventListener("click",t=>{const s=e.getAttribute("href");if(s.startsWith("#/")){t.preventDefault();const i=`view-${s.replace("#/","")||"home"}`,o=document.getElementById(i);o&&this.systems.transitions.play(()=>{var r;(r=this.systems.Scroll)!=null&&r.scrollTo?this.systems.Scroll.scrollTo(o.offsetTop-80):window.scrollTo({top:o.offsetTop-80,behavior:"instant"}),history.pushState(null,null,s)})}})})}async launch(e,t){try{const s=await t();this.systems[e]=s.default||s}catch(s){console.warn(`‚ö†Ô∏è [${e}] Launch inhibited:`,s)}}ensurePremiumStructuralHarmony(){var e;(e=document.querySelector(".nav__inner"))==null||e.classList.add("divinity-active")}initLegacyModules(){const e=new _({maxDist:150,influence:.15,staggerDelay:.02}).init(".kinetic-text"),t=new Y({attraction:.2}).init(".magnetic-btn");this.systems.kineticText=e,this.systems.magneticButton=t,y.initAll(),q.initAll(),I.init(),this.systems.spotify=new P,this.launch("LiquidDistortion",()=>m(()=>import("./liquid-distortion-BiSUU0OZ.js"),__vite__mapDeps([3,1])))}}window.Naroa=new D;
./run_swarm_ui.cjs:  console.log('üöÄ Launching Fractal Swarm (40 Agents) for UI Upgrade...');
./run_swarm_ui.cjs:    console.log('\n‚úÖ Mission Complete!');
./run_swarm_ui.cjs:    console.log('üìÑ Report generated at:', report.filePath);
./run_swarm_ui.cjs:        console.log('\n--- REPORT SUMMARY ---\n');
./run_swarm_ui.cjs:        console.log(fs.readFileSync(report.filePath, 'utf8').substring(0, 3000));
./legacy/mica-hero-standalone-docs.html:        console.log('Micr√≥fono activado');
./legacy/mica-hero-standalone-docs.html:    console.log('‚ú® MICA Hero System Initialized');
./legacy/mica-hero-standalone.html:        console.log('Micr√≥fono activado');
./legacy/mica-hero-standalone.html:    console.log('‚ú® MICA Hero System Initialized');
./docs/NAROA-WEBGL-ARCHITECTURE.md:  console.log(`Visualizando: ${work.titulo}`);
./mixcraft/dist/assets/index-iPVkFKWZ.js:    `}}class O{constructor(t){this.app=t,this.masterChain=t.audioEngine.masterChain,this.dom={}}init(){this._setupMasterChainUI(),this._setupCrossfader()}_setupMasterChainUI(){document.getElementById("master-channel")&&(this._bindKnob("#mc-comp-thresh",e=>{var i;return(i=this.masterChain)==null?void 0:i.setCompressorParams({threshold:parseFloat(e)})}),this._bindKnob("#mc-comp-ratio",e=>{var i;return(i=this.masterChain)==null?void 0:i.setCompressorParams({ratio:parseFloat(e)})}),this._bindKnob("#mc-eq-low",e=>{var i;return(i=this.masterChain)==null?void 0:i.setEQParams({low:parseFloat(e)})}),this._bindKnob("#mc-eq-mid",e=>{var i;return(i=this.masterChain)==null?void 0:i.setEQParams({mid:parseFloat(e)})}),this._bindKnob("#mc-eq-high",e=>{var i;return(i=this.masterChain)==null?void 0:i.setEQParams({high:parseFloat(e)})}),this._bindKnob("#mc-gain",e=>{var i;return(i=this.masterChain)==null?void 0:i.setGain(parseFloat(e))}))}_setupCrossfader(){const t=document.getElementById("crossfader");t&&t.addEventListener("input",e=>{const i=parseFloat(e.target.value);this.app.audioEngine.setCrossfade(i)})}_bindKnob(t,e){const i=document.querySelector(t);i&&i.addEventListener("input",s=>{e(s.target.value);const n=i.parentElement.querySelector(".knob-val");n&&(n.textContent=s.target.value)})}update(t){if(!t)return;const{rmsDb:e,peakDb:i,lufsEstimate:s}=t;this._updateMeter("master-l",e,i),this._updateMeter("master-r",e,i);const n=document.getElementById("mc-lufs-val");n&&(n.textContent=s.toFixed(1));const a=this._simulateReduction(e);this._updateReductionMeter(a)}_simulateReduction(t){if(!this.masterChain||!this.masterChain.compressor)return 0;const e=this.masterChain.compressor.threshold.value,i=this.masterChain.compressor.ratio.value;return t>e?(t-e)*(1-1/i):0}_updateReductionMeter(t){const e=document.getElementById("mc-comp-reduction");if(!e)return;const i=e.querySelector(".meter-fill");if(i){const s=Math.min(100,t/20*100);i.style.height=`${s}%`,i.style.opacity=s>0?1:.2}}_updateMeter(t,e,i){const s=document.getElementById(t);if(!s)return;const n=s.querySelector(".meter-fill");if(n){const r=(Math.max(-60,e)+60)/60*100;n.style.height=`${r}%`}}}class Q{constructor(t){this.app=t,this.fxEngine=t.audioEngine.fxEngine}init(){this._setupControls()}_setupControls(){this._bindFXControl("reverb-wet",t=>this.fxEngine.setReverbWet(t)),this._bindFXControl("reverb-decay",t=>this.fxEngine.setReverbDecay(t)),this._bindFXControl("delay-time",t=>this.fxEngine.setDelayTime(t)),this._bindFXControl("delay-feedback",t=>this.fxEngine.setDelayFeedback(t)),this._bindFXControl("delay-wet",t=>this.fxEngine.setDelayWet(t)),this._bindFXControl("filter-freq",t=>this.fxEngine.setFilterFreq(t)),this._bindFXControl("filter-res",t=>this.fxEngine.setFilterResonance(t)),this._bindFXControl("dist-drive",t=>this.fxEngine.setDistortionDrive(t)),this._bindFXControl("dist-mix",t=>this.fxEngine.setDistortionMix(t)),document.querySelectorAll(".fx-power").forEach(t=>{t.addEventListener("click",e=>{const i=e.target.dataset.fx;e.target.classList.contains("on")?(e.target.classList.remove("on"),i==="filter"&&this.fxEngine.toggleFilter(!1)):(e.target.classList.add("on"),i==="filter"&&this.fxEngine.toggleFilter(!0))})})}_bindFXControl(t,e){const i=document.getElementById(`fx-${t}`);i&&i.addEventListener("input",s=>{const n=parseFloat(s.target.value);e(n);const a=i.parentElement.querySelector(".knob-val");a&&(a.textContent=n.toFixed(2))})}}class V{constructor(t){this.app=t,this.audio=t.audioEngine,this.components={},this.dom={header:document.getElementById("app-header"),main:document.getElementById("app-main"),loading:document.getElementById("loading-screen")}}async init(){console.log("[UIManager] Initializing Sovereign Interface..."),this.components.transport=new W(this.app),this.components.mixer=new O(this.app),this.components.fxRack=new Q(this.app),this._setupGlobalKeys(),this._setupDragDrop(),await this.components.transport.init(),await this.components.mixer.init(),await this.components.fxRack.init(),this.update(),console.log("[UIManager] Interface Ready.")}update(t){this.components.transport&&this.components.transport.update(),this.components.mixer&&this.components.mixer.update(t)}_setupGlobalKeys(){document.addEventListener("keydown",t=>{t.code==="Escape"&&this.toggleShortcutsModal()})}_setupDragDrop(){const t=document.getElementById("drop-overlay");document.addEventListener("dragover",e=>{e.preventDefault(),t.classList.remove("hidden")}),document.addEventListener("dragleave",e=>{e.target===t&&t.classList.add("hidden")}),document.addEventListener("drop",async e=>{e.preventDefault(),t.classList.add("hidden");const i=Array.from(e.dataTransfer.files).filter(s=>s.type.startsWith("audio/"));i.length>0&&this.app.handleFileDrop(i)})}toggleLoading(t){t?(this.dom.loading.classList.remove("loaded"),this.dom.loading.style.visibility="visible"):(this.dom.loading.classList.add("loaded"),setTimeout(()=>{this.dom.loading.style.visibility="hidden"},800))}}class N{constructor(t,e){this.ctx=t,this.dest=e,this.samples={},this.generateDrumSamples()}generateDrumSamples(){this.samples={1:()=>this._kick(),2:()=>this._snare(),3:()=>this._hihat(),4:()=>this._clap(),5:()=>this._tom(),6:()=>this._ride(),7:()=>this._fx1(),8:()=>this._fx2()}}trigger(t){this.samples[t]&&this.samples[t]()}_kick(){this._tone(150,.01,.5)}_tom(){this._tone(200,50,.3)}_fx1(){this._tone(4e3,100,.3,"sawtooth")}_fx2(){this._tone(200,2e3,.5,"sine","linear")}_tone(t,e,i,s="sine",n="exponential"){const a=this.ctx.createOscillator(),r=this.ctx.createGain();a.type=s,a.frequency.setValueAtTime(t,this.ctx.currentTime),n==="exponential"?a.frequency.exponentialRampToValueAtTime(e,this.ctx.currentTime+i):a.frequency.linearRampToValueAtTime(e,this.ctx.currentTime+i),r.gain.setValueAtTime(1,this.ctx.currentTime),r.gain.exponentialRampToValueAtTime(.001,this.ctx.currentTime+i),a.connect(r),r.connect(this.dest),a.start(),a.stop(this.ctx.currentTime+i)}_snare(){this._noise(.2,1e3,"highpass"),this._tone(200,.01,.1,"triangle")}_hihat(){this._noise(.05,7e3,"highpass")}_ride(){this._noise(.4,1e4,"bandpass")}_noise(t,e,i){const s=this.ctx.createBufferSource(),n=this.ctx.createBuffer(1,this.ctx.sampleRate*t,this.ctx.sampleRate),a=n.getChannelData(0);for(let c=0;c<a.length;c++)a[c]=Math.random()*2-1;s.buffer=n;const r=this.ctx.createBiquadFilter();r.type=i,r.frequency.value=e;const o=this.ctx.createGain();o.gain.setValueAtTime(.5,this.ctx.currentTime),o.gain.exponentialRampToValueAtTime(.001,this.ctx.currentTime+t),s.connect(r),r.connect(o),o.connect(this.dest),s.start()}_clap(){for(let t=0;t<3;t++)setTimeout(()=>this._noise(.02,2500,"bandpass"),t*10)}}class j{constructor(t){this.canvas=t,this.ctx=t.getContext("2d"),this._resizeObserver=new ResizeObserver(()=>this._resize()),t&&this._resizeObserver.observe(t)}_resize(){if(!this.canvas)return;const t=this.canvas.getBoundingClientRect(),e=window.devicePixelRatio||1;this.canvas.width=t.width*e,this.canvas.height=t.height*e,this.ctx.scale(e,e),this.width=t.width,this.height=t.height}draw(t){if(!this.canvas||!t)return;const{ctx:e,width:i,height:s}=this;e.clearRect(0,0,i,s);const n=Math.min(t.length,64),a=i/n;for(let r=0;r<n;r++){const c=t[r]/255*s;e.fillStyle=`hsla(${120+r*2}, 100%, 50%, 0.8)`,e.fillRect(r*a,s-c,a-2,c)}}}class U{constructor(){this.audioEngine=new B,this.isInitialized=!1,this.isPlaying=!1,this.nextDeck="A",this.hotCues={A:{},B:{}},this.ui=new V(this),this.exporter=new E,this.visualizer=null,this.spectrum=null,this.waveforms={A:null,B:null},this.fxEngine=null,this.masterChain=null,this.samplePads=null,this.timeline=null,this._boot()}async _boot(){console.log("[EuskAI mixer] Booting..."),await this.ui.init(),this._setupVisualizers(),this._startAnimationLoop(),await this._loadDemoTracks(),this.ui.toggleLoading(!1),console.log("%c‚óà EUSKAI MIXER V1 ‚óà %cLiquid Glass Engine Ready","color: #CCFF00; font-weight: bold; font-size: 16px; background: #000; padding: 4px;","color: #7B2FFF; background: #000; padding: 4px;")}async _loadDemoTracks(){console.log("[Demo] Loading Robe Remix Stems...");const t=[{id:"A",path:"/sound_design/robe_remix/loop_riser.wav",name:"Robe Riser (Loop)"},{id:"B",path:"/sound_design/robe_remix/memory_glitch.wav",name:"Memory Glitch"}];for(const e of t)try{const i=await fetch(e.path);if(!i.ok)throw new Error(`Failed to fetch ${e.path}`);const s=await i.blob(),n=new File([s],e.name,{type:"audio/wav"});await this.loadTrack(e.id,n)}catch(i){console.warn(`[Demo] Could not load track ${e.name}:`,i)}}async _ensureAudio(){if(!this.isInitialized){await this.audioEngine.init();const t=this.audioEngine.ctx;this.fxEngine=new I(t),this.audioEngine.fxEngine=this.fxEngine,this.masterChain=new G(t),this.audioEngine.masterChain=this.masterChain,this.samplePads=new N(t,this.audioEngine.masterGain),this.audioEngine.masterGain.disconnect(),this.audioEngine.masterGain.connect(this.masterChain.input),this.masterChain.output.connect(t.destination),this.isInitialized=!0}}_setupVisualizers(){const t=document.getElementById("waveform-a"),e=document.getElementById("waveform-b");t&&(this.waveforms.A=new S(t,{waveColor:"#CCFF00"})),e&&(this.waveforms.B=new S(e,{waveColor:"#7B2FFF"}));const i=document.getElementById("visualizer-canvas");i&&(this.visualizer=new $(i));const s=document.getElementById("spectrum-canvas");s&&(this.spectrum=new j(s));const n=document.getElementById("timeline-container"),a=document.getElementById("timeline-ruler");n&&(this.timeline=new z(n,a))}async togglePlayback(){var t,e;await this._ensureAudio(),this.audioEngine.isPlaying?(this.audioEngine.pause(),(t=this.visualizer)==null||t.stop()):(this.audioEngine.play(),(e=this.visualizer)==null||e.start())}async toggleRecording(){console.log("[App] Recording toggle requested")}async handleFileDrop(t){for(const e of t)await this.loadTrack(this.nextDeck,e),this.nextDeck=this.nextDeck==="A"?"B":"A"}async loadTrack(t,e){var i,s;await this._ensureAudio();try{const n=await this.audioEngine.loadTrack(t,e);(i=this.waveforms[t])==null||i.setWaveformData(n.waveformData),(s=this.timeline)==null||s.addTrack(n),console.log(`Loaded ${n.name} to Deck ${t}`)}catch(n){console.error(n)}}_startAnimationLoop(){const t=()=>{var n;let e=null,i=null,s=null;this.isInitialized&&this.audioEngine.isPlaying&&(e=this.audioEngine.getAnalyserData(),i=this.audioEngine.getAnalyserTimeData(),s=(n=this.masterChain)==null?void 0:n.getAnalysis()),this.visualizer&&this.audioEngine.isPlaying&&this.visualizer.draw(e,i),this.spectrum&&this.spectrum.draw(e),this.ui.update(s),requestAnimationFrame(t)};t()}}window.mixcraft=new U;
./mixcraft/dist/assets/index-iPVkFKWZ.js.map:{"version":3,"file":"index-iPVkFKWZ.js","sources":["../../src/audio/audio-engine.js","../../src/audio/waveform-renderer.js","../../src/fx/fx-engine.js","../../src/audio/master-chain.js","../../src/timeline/timeline.js","../../src/viz/visualizer.js","../../src/export/exporter.js","../../src/ui/components/Transport.js","../../src/ui/components/Mixer.js","../../src/ui/components/FXRack.js","../../src/ui/UIManager.js","../../src/audio/sample-engine.js","../../src/app.js"],"sourcesContent":["/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Audio Engine ‚Äî Core Web Audio API\n   BPM detection, key detection, decode, playback\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\n// Camelot Wheel ‚Äî compatibilidad arm√≥nica\nconst CAMELOT_WHEEL = {\n  'C':  { major: '8B',  minor: '5A'  },\n  'C#': { major: '3B',  minor: '12A' },\n  'Db': { major: '3B',  minor: '12A' },\n  'D':  { major: '10B', minor: '7A'  },\n  'D#': { major: '5B',  minor: '2A'  },\n  'Eb': { major: '5B',  minor: '2A'  },\n  'E':  { major: '12B', minor: '9A'  },\n  'F':  { major: '7B',  minor: '4A'  },\n  'F#': { major: '2B',  minor: '11A' },\n  'Gb': { major: '2B',  minor: '11A' },\n  'G':  { major: '9B',  minor: '6A'  },\n  'G#': { major: '4B',  minor: '1A'  },\n  'Ab': { major: '4B',  minor: '1A'  },\n  'A':  { major: '11B', minor: '8A'  },\n  'A#': { major: '6B',  minor: '3A'  },\n  'Bb': { major: '6B',  minor: '3A'  },\n  'B':  { major: '1B',  minor: '10A' },\n};\n\n// Notas crom√°ticas para detecci√≥n de key\nconst NOTE_NAMES = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n// Perfiles arm√≥nicos (Krumhansl-Schmuckler)\nconst MAJOR_PROFILE = [6.35, 2.23, 3.48, 2.33, 4.38, 4.09, 2.52, 5.19, 2.39, 3.66, 2.29, 2.88];\nconst MINOR_PROFILE = [6.33, 2.68, 3.52, 5.38, 2.60, 3.53, 2.54, 4.75, 3.98, 2.69, 3.34, 3.17];\n\nexport class AudioEngine {\n  constructor() {\n    this.ctx = null;\n    this.masterGain = null;\n    this.analyser = null;\n    this.decks = { A: null, B: null };\n    this.isPlaying = false;\n    this.startTime = 0;\n    this.pauseOffset = 0;\n  }\n\n  // Inicializar AudioContext (requiere interacci√≥n de usuario)\n  async init() {\n    if (this.ctx) return;\n    this.ctx = new (window.AudioContext || window.webkitAudioContext)();\n\n    // Master chain\n    this.masterGain = this.ctx.createGain();\n    this.analyser = this.ctx.createAnalyser();\n    this.analyser.fftSize = 2048;\n    this.analyser.smoothingTimeConstant = 0.85;\n\n    this.masterGain.connect(this.analyser);\n    this.analyser.connect(this.ctx.destination);\n\n    // Inicializar decks\n    this.decks.A = this._createDeck('A');\n    this.decks.B = this._createDeck('B');\n  }\n\n  _createDeck(id) {\n    return {\n      id,\n      buffer: null,\n      source: null,\n      gainNode: this.ctx.createGain(),\n      eqHi: this._createEQ(3200, 'highshelf'),\n      eqMid: this._createEQ(1000, 'peaking'),\n      eqLo: this._createEQ(320, 'lowshelf'),\n      analyser: this._createDeckAnalyser(),\n      bpm: 0,\n      key: '',\n      camelot: '',\n      duration: 0,\n      name: '',\n      isLoaded: false,\n      waveformData: null,\n    };\n  }\n\n  _createEQ(freq, type) {\n    const eq = this.ctx.createBiquadFilter();\n    eq.type = type;\n    eq.frequency.value = freq;\n    eq.gain.value = 0;\n    if (type === 'peaking') eq.Q.value = 1.0;\n    return eq;\n  }\n\n  _createDeckAnalyser() {\n    const a = this.ctx.createAnalyser();\n    a.fftSize = 256;\n    a.smoothingTimeConstant = 0.8;\n    return a;\n  }\n\n  // Cargar archivo de audio en un deck\n  async loadTrack(deckId, file) {\n    await this.init();\n    const deck = this.decks[deckId];\n\n    const arrayBuffer = await file.arrayBuffer();\n    deck.buffer = await this.ctx.decodeAudioData(arrayBuffer);\n    deck.duration = deck.buffer.duration;\n    deck.name = file.name.replace(/\\.[^/.]+$/, '');\n    deck.isLoaded = true;\n\n    // Extraer waveform\n    deck.waveformData = this._extractWaveform(deck.buffer);\n\n    // Detectar BPM\n    deck.bpm = this._detectBPM(deck.buffer);\n\n    // Detectar Key\n    const keyResult = this._detectKey(deck.buffer);\n    deck.key = keyResult.key;\n    deck.camelot = keyResult.camelot;\n\n    return deck;\n  }\n\n  // Extraer datos de waveform para renderizar\n  _extractWaveform(buffer, samples = 1000) {\n    const channel = buffer.getChannelData(0);\n    const blockSize = Math.floor(channel.length / samples);\n    const peaks = new Float32Array(samples);\n\n    for (let i = 0; i < samples; i++) {\n      let max = 0;\n      const start = i * blockSize;\n      for (let j = 0; j < blockSize; j++) {\n        const abs = Math.abs(channel[start + j]);\n        if (abs > max) max = abs;\n      }\n      peaks[i] = max;\n    }\n    return peaks;\n  }\n\n  // Detecci√≥n de BPM ‚Äî onset detection con autocorrelaci√≥n\n  _detectBPM(buffer) {\n    const channel = buffer.getChannelData(0);\n    const sampleRate = buffer.sampleRate;\n\n    // Downsample para eficiencia\n    const downFactor = 4;\n    const downLength = Math.floor(channel.length / downFactor);\n    const downsampled = new Float32Array(downLength);\n    for (let i = 0; i < downLength; i++) {\n      downsampled[i] = Math.abs(channel[i * downFactor]);\n    }\n\n    // Onset detection ‚Äî energ√≠a por ventana\n    const windowSize = Math.floor(sampleRate / downFactor * 0.02); // 20ms\n    const onsets = [];\n    for (let i = windowSize; i < downsampled.length; i += windowSize) {\n      let energy = 0;\n      let prevEnergy = 0;\n      for (let j = 0; j < windowSize; j++) {\n        energy += downsampled[i + j] ** 2;\n        prevEnergy += downsampled[i - windowSize + j] ** 2;\n      }\n      onsets.push(Math.max(0, energy - prevEnergy));\n    }\n\n    // Autocorrelaci√≥n en rango BPM 60-200\n    const effectiveRate = sampleRate / downFactor / windowSize;\n    const minLag = Math.floor(effectiveRate * 60 / 200);\n    const maxLag = Math.floor(effectiveRate * 60 / 60);\n\n    let bestCorr = 0;\n    let bestLag = minLag;\n\n    for (let lag = minLag; lag <= Math.min(maxLag, onsets.length / 2); lag++) {\n      let corr = 0;\n      const normalizer = onsets.length - lag;\n      for (let i = 0; i < normalizer; i++) {\n        corr += onsets[i] * onsets[i + lag];\n      }\n      corr /= normalizer;\n      if (corr > bestCorr) {\n        bestCorr = corr;\n        bestLag = lag;\n      }\n    }\n\n    const bpm = (effectiveRate * 60) / bestLag;\n    // Normalizar a rango razonable\n    let normalizedBpm = bpm;\n    while (normalizedBpm < 70) normalizedBpm *= 2;\n    while (normalizedBpm > 180) normalizedBpm /= 2;\n\n    return Math.round(normalizedBpm * 10) / 10;\n  }\n\n  // Detecci√≥n de tonalidad ‚Äî Krumhansl-Schmuckler\n  _detectKey(buffer) {\n    const channel = buffer.getChannelData(0);\n    const sampleRate = buffer.sampleRate;\n\n    // FFT manual (usar ventana central del track)\n    const centerStart = Math.floor(channel.length * 0.25);\n    const fftSize = 8192;\n    const segment = channel.slice(centerStart, centerStart + fftSize);\n\n    // Chroma vector ‚Äî energ√≠a por nota\n    const chroma = new Float32Array(12);\n\n    // Simplified chroma extraction usando bin frequencies\n    for (let bin = 1; bin < fftSize / 2; bin++) {\n      const freq = bin * sampleRate / fftSize;\n      if (freq < 50 || freq > 5000) continue;\n\n      // Qu√© nota crom√°tica es esta frecuencia\n      const noteNum = 12 * Math.log2(freq / 440) + 69;\n      const noteIndex = ((Math.round(noteNum) % 12) + 12) % 12;\n\n      // Energ√≠a del bin\n      const energy = segment[bin] ** 2;\n      chroma[noteIndex] += Math.abs(energy);\n    }\n\n    // Normalizar chroma\n    const maxChroma = Math.max(...chroma);\n    if (maxChroma > 0) {\n      for (let i = 0; i < 12; i++) chroma[i] /= maxChroma;\n    }\n\n    // Correlacionar con perfiles de major y minor\n    let bestKey = 'C';\n    let bestMode = 'major';\n    let bestCorr = -Infinity;\n\n    for (let shift = 0; shift < 12; shift++) {\n      // Rotar chroma\n      let corrMajor = 0, corrMinor = 0;\n      for (let i = 0; i < 12; i++) {\n        const idx = (i + shift) % 12;\n        corrMajor += chroma[idx] * MAJOR_PROFILE[i];\n        corrMinor += chroma[idx] * MINOR_PROFILE[i];\n      }\n\n      if (corrMajor > bestCorr) {\n        bestCorr = corrMajor;\n        bestKey = NOTE_NAMES[shift];\n        bestMode = 'major';\n      }\n      if (corrMinor > bestCorr) {\n        bestCorr = corrMinor;\n        bestKey = NOTE_NAMES[shift];\n        bestMode = 'minor';\n      }\n    }\n\n    const camelotInfo = CAMELOT_WHEEL[bestKey];\n    const camelot = camelotInfo ? camelotInfo[bestMode] : '?';\n\n    return {\n      key: `${bestKey}${bestMode === 'minor' ? 'm' : ''}`,\n      camelot,\n      mode: bestMode,\n    };\n  }\n\n  // Conectar deck a master output\n  _connectDeck(deck) {\n    if (deck.source) {\n      try { deck.source.stop(); } catch (e) { /* ya parado */ }\n    }\n\n    deck.source = this.ctx.createBufferSource();\n    deck.source.buffer = deck.buffer;\n\n    // Chain: source ‚Üí EQ Hi ‚Üí EQ Mid ‚Üí EQ Lo ‚Üí Gain ‚Üí Analyser ‚Üí Master\n    deck.source.connect(deck.eqHi);\n    deck.eqHi.connect(deck.eqMid);\n    deck.eqMid.connect(deck.eqLo);\n    deck.eqLo.connect(deck.gainNode);\n    deck.gainNode.connect(deck.analyser);\n    deck.analyser.connect(this.masterGain);\n  }\n\n  // Reproducir ambos decks\n  play() {\n    if (this.isPlaying) return;\n    if (!this.ctx) return;\n\n    this.isPlaying = true;\n\n    for (const id of ['A', 'B']) {\n      const deck = this.decks[id];\n      if (!deck.isLoaded) continue;\n\n      this._connectDeck(deck);\n      deck.source.start(0, this.pauseOffset);\n    }\n\n    this.startTime = this.ctx.currentTime - this.pauseOffset;\n  }\n\n  // Pausar\n  pause() {\n    if (!this.isPlaying) return;\n    this.isPlaying = false;\n    this.pauseOffset = this.ctx.currentTime - this.startTime;\n\n    for (const id of ['A', 'B']) {\n      const deck = this.decks[id];\n      if (deck.source) {\n        try { deck.source.stop(); } catch (e) { /* ok */ }\n      }\n    }\n  }\n\n  // Stop (reset al inicio)\n  stop() {\n    this.pause();\n    this.pauseOffset = 0;\n    this.startTime = 0;\n  }\n\n  // Seek a posici√≥n\n  seek(time) {\n    const wasPlaying = this.isPlaying;\n    if (wasPlaying) this.pause();\n    this.pauseOffset = time;\n    if (wasPlaying) this.play();\n  }\n\n  // Obtener tiempo actual de playback\n  getCurrentTime() {\n    if (!this.ctx) return 0;\n    if (this.isPlaying) {\n      return this.ctx.currentTime - this.startTime;\n    }\n    return this.pauseOffset;\n  }\n\n  // Duraci√≥n m√°xima entre los dos decks\n  getTotalDuration() {\n    let maxDur = 0;\n    for (const id of ['A', 'B']) {\n      if (this.decks[id].isLoaded) {\n        maxDur = Math.max(maxDur, this.decks[id].duration);\n      }\n    }\n    return maxDur;\n  }\n\n  // Ajustar volumen de un deck\n  setDeckVolume(deckId, value) {\n    const deck = this.decks[deckId];\n    if (deck) deck.gainNode.gain.value = value;\n  }\n\n  // Ajustar EQ\n  setDeckEQ(deckId, band, value) {\n    const deck = this.decks[deckId];\n    if (!deck) return;\n    const eqMap = { hi: deck.eqHi, mid: deck.eqMid, lo: deck.eqLo };\n    if (eqMap[band]) eqMap[band].gain.value = value;\n  }\n\n  // Crossfader - distribuci√≥n de volumen entre decks\n  setCrossfade(value) {\n    // value: 0 = full A, 0.5 = center, 1 = full B\n    const volA = Math.cos(value * Math.PI / 2);\n    const volB = Math.sin(value * Math.PI / 2);\n    this.decks.A.gainNode.gain.value = volA;\n    this.decks.B.gainNode.gain.value = volB;\n  }\n\n  // Obtener datos del analyser para visualizaci√≥n\n  getAnalyserData() {\n    if (!this.analyser) return null;\n    const data = new Uint8Array(this.analyser.frequencyBinCount);\n    this.analyser.getByteFrequencyData(data);\n    return data;\n  }\n\n  getAnalyserTimeData() {\n    if (!this.analyser) return null;\n    const data = new Uint8Array(this.analyser.frequencyBinCount);\n    this.analyser.getByteTimeDomainData(data);\n    return data;\n  }\n\n  // Verificar compatibilidad arm√≥nica entre dos camelot keys\n  static getHarmonicScore(camelot1, camelot2) {\n    if (!camelot1 || !camelot2) return 0;\n\n    const num1 = parseInt(camelot1);\n    const letter1 = camelot1.slice(-1);\n    const num2 = parseInt(camelot2);\n    const letter2 = camelot2.slice(-1);\n\n    // Misma key = perfect match\n    if (camelot1 === camelot2) return 100;\n\n    // Mismo n√∫mero, diferente letra (A/B) = compatible\n    if (num1 === num2) return 90;\n\n    // +1 o -1 con misma letra = compatible\n    const diff = Math.abs(num1 - num2);\n    if (letter1 === letter2 && (diff === 1 || diff === 11)) return 80;\n\n    // +2 o -2 = semi-compatible\n    if (letter1 === letter2 && (diff === 2 || diff === 10)) return 60;\n\n    return Math.max(0, 50 - diff * 8);\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Waveform Renderer ‚Äî Canvas de alta resoluci√≥n\n   Peaks coloreadas, cursor, zoom\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class WaveformRenderer {\n  constructor(canvas, options = {}) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d');\n    this.waveformData = null;\n    this.playProgress = 0; // 0-1\n\n    // Opciones\n    this.colors = {\n      wave: options.waveColor || '#CCFF00',\n      wavePlayed: options.wavePlayedColor || 'rgba(204, 255, 0, 0.4)',\n      bg: options.bgColor || '#0A0A0A',\n      cursor: options.cursorColor || '#CCFF00',\n      center: options.centerColor || 'rgba(255,255,255,0.05)',\n    };\n\n    this._resize();\n    this._resizeObserver = new ResizeObserver(() => this._resize());\n    this._resizeObserver.observe(canvas);\n  }\n\n  _resize() {\n    const rect = this.canvas.getBoundingClientRect();\n    const dpr = window.devicePixelRatio || 1;\n    this.canvas.width = rect.width * dpr;\n    this.canvas.height = rect.height * dpr;\n    this.ctx.scale(dpr, dpr);\n    this.width = rect.width;\n    this.height = rect.height;\n    this.render();\n  }\n\n  setWaveformData(data) {\n    this.waveformData = data;\n    this.render();\n  }\n\n  setProgress(progress) {\n    this.playProgress = Math.max(0, Math.min(1, progress));\n    this.render();\n  }\n\n  render() {\n    const { ctx, width, height, waveformData, playProgress, colors } = this;\n\n    // Clear\n    ctx.fillStyle = colors.bg;\n    ctx.fillRect(0, 0, width, height);\n\n    if (!waveformData || waveformData.length === 0) {\n      // Empty state ‚Äî l√≠nea central\n      ctx.strokeStyle = colors.center;\n      ctx.lineWidth = 1;\n      ctx.beginPath();\n      ctx.moveTo(0, height / 2);\n      ctx.lineTo(width, height / 2);\n      ctx.stroke();\n      return;\n    }\n\n    const centerY = height / 2;\n    const barWidth = width / waveformData.length;\n    const playX = playProgress * width;\n\n    // L√≠nea central\n    ctx.strokeStyle = colors.center;\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.moveTo(0, centerY);\n    ctx.lineTo(width, centerY);\n    ctx.stroke();\n\n    // Dibujar peaks\n    for (let i = 0; i < waveformData.length; i++) {\n      const x = i * barWidth;\n      const amplitude = waveformData[i] * centerY * 0.9;\n\n      // Color basado en posici√≥n vs cursor\n      if (x < playX) {\n        ctx.fillStyle = colors.wavePlayed;\n      } else {\n        ctx.fillStyle = colors.wave;\n      }\n\n      // Barra superior e inferior (mirror)\n      const bw = Math.max(1, barWidth - 0.5);\n      ctx.fillRect(x, centerY - amplitude, bw, amplitude);\n      ctx.fillRect(x, centerY, bw, amplitude * 0.6);\n    }\n\n    // Cursor de reproducci√≥n\n    if (playProgress > 0 && playProgress < 1) {\n      ctx.strokeStyle = colors.cursor;\n      ctx.lineWidth = 2;\n      ctx.shadowColor = colors.cursor;\n      ctx.shadowBlur = 8;\n      ctx.beginPath();\n      ctx.moveTo(playX, 0);\n      ctx.lineTo(playX, height);\n      ctx.stroke();\n      ctx.shadowBlur = 0;\n    }\n  }\n\n  // Obtener posici√≥n temporal del click\n  getTimeFromClick(e) {\n    const rect = this.canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    return x / this.width; // 0-1 progress\n  }\n\n  destroy() {\n    this._resizeObserver?.disconnect();\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   FX Engine v2 ‚Äî Cadena de efectos GOD MODE\n   Reverb, Delay, Filter, Distortion/Crush, Phaser\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class FXEngine {\n  constructor(audioCtx) {\n    this.ctx = audioCtx;\n    this.effects = {};\n    this.input = this.ctx.createGain();\n    this.output = this.ctx.createGain();\n    this.dry = this.ctx.createGain();\n    this.dry.gain.value = 1;\n\n    this._initReverb();\n    this._initDelay();\n    this._initFilter();\n    this._initDistortion();\n    this._initPhaser();\n\n    // Dry path\n    this.input.connect(this.dry);\n    this.dry.connect(this.output);\n  }\n\n  // ‚îÄ‚îÄ‚îÄ REVERB (ConvolverNode) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _initReverb() {\n    const reverb = {\n      convolver: this.ctx.createConvolver(),\n      wet: this.ctx.createGain(),\n      decay: 2,\n      wetValue: 0,\n    };\n\n    reverb.wet.gain.value = 0;\n    this.input.connect(reverb.convolver);\n    reverb.convolver.connect(reverb.wet);\n    reverb.wet.connect(this.output);\n\n    // Generar impulse response sint√©tico\n    this._generateIR(reverb.decay).then(buffer => {\n      reverb.convolver.buffer = buffer;\n    });\n\n    this.effects.reverb = reverb;\n  }\n\n  async _generateIR(decay) {\n    const rate = this.ctx.sampleRate;\n    const length = rate * Math.min(decay, 8);\n    const buffer = this.ctx.createBuffer(2, length, rate);\n\n    for (let ch = 0; ch < 2; ch++) {\n      const channel = buffer.getChannelData(ch);\n      for (let i = 0; i < length; i++) {\n        // Ruido blanco con decaimiento exponencial + difusi√≥n est√©reo\n        const diffusion = ch === 0 ? 1 : -1;\n        channel[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / length, decay) * (1 + diffusion * 0.1 * Math.random());\n      }\n    }\n    return buffer;\n  }\n\n  setReverbWet(value) {\n    this.effects.reverb.wet.gain.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.effects.reverb.wetValue = value;\n  }\n\n  async setReverbDecay(value) {\n    this.effects.reverb.decay = value;\n    const buffer = await this._generateIR(value);\n    this.effects.reverb.convolver.buffer = buffer;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ DELAY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _initDelay() {\n    const delay = {\n      node: this.ctx.createDelay(5),\n      feedback: this.ctx.createGain(),\n      wet: this.ctx.createGain(),\n      hp: this.ctx.createBiquadFilter(), // High-pass en el feedback loop para que no se acumule mud\n      feedbackValue: 0.4,\n      timeValue: 0.3,\n      wetValue: 0,\n    };\n\n    delay.node.delayTime.value = 0.3;\n    delay.feedback.gain.value = 0.4;\n    delay.wet.gain.value = 0;\n    delay.hp.type = 'highpass';\n    delay.hp.frequency.value = 200;\n\n    this.input.connect(delay.node);\n    delay.node.connect(delay.hp);\n    delay.hp.connect(delay.feedback);\n    delay.feedback.connect(delay.node);\n    delay.node.connect(delay.wet);\n    delay.wet.connect(this.output);\n\n    this.effects.delay = delay;\n  }\n\n  setDelayTime(value) {\n    this.effects.delay.node.delayTime.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.effects.delay.timeValue = value;\n  }\n\n  setDelayFeedback(value) {\n    this.effects.delay.feedback.gain.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.effects.delay.feedbackValue = value;\n  }\n\n  setDelayWet(value) {\n    this.effects.delay.wet.gain.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.effects.delay.wetValue = value;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ FILTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _initFilter() {\n    const filter = {\n      node: this.ctx.createBiquadFilter(),\n      active: false,\n    };\n\n    filter.node.type = 'lowpass';\n    filter.node.frequency.value = 1000;\n    filter.node.Q.value = 1;\n\n    this.effects.filter = filter;\n  }\n\n  setFilterType(type) {\n    this.effects.filter.node.type = type;\n  }\n\n  setFilterFreq(value) {\n    this.effects.filter.node.frequency.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n  }\n\n  setFilterResonance(value) {\n    this.effects.filter.node.Q.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n  }\n\n  toggleFilter(active) {\n    const filter = this.effects.filter;\n    if (active && !filter.active) {\n      this.input.disconnect(this.dry);\n      this.input.connect(filter.node);\n      filter.node.connect(this.dry);\n      filter.active = true;\n    } else if (!active && filter.active) {\n      this.input.disconnect(filter.node);\n      filter.node.disconnect(this.dry);\n      this.input.connect(this.dry);\n      filter.active = false;\n    }\n  }\n\n  // ‚îÄ‚îÄ‚îÄ DISTORTION / BITCRUSHER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _initDistortion() {\n    const dist = {\n      shaper: this.ctx.createWaveShaper(),\n      wet: this.ctx.createGain(),\n      preGain: this.ctx.createGain(),\n      postGain: this.ctx.createGain(),\n      drive: 0,\n      wetValue: 0,\n    };\n\n    dist.wet.gain.value = 0;\n    dist.preGain.gain.value = 1;\n    dist.postGain.gain.value = 0.5;\n    dist.shaper.curve = this._makeDistortionCurve(0);\n    dist.shaper.oversample = '4x';\n\n    this.input.connect(dist.preGain);\n    dist.preGain.connect(dist.shaper);\n    dist.shaper.connect(dist.postGain);\n    dist.postGain.connect(dist.wet);\n    dist.wet.connect(this.output);\n\n    this.effects.distortion = dist;\n  }\n\n  _makeDistortionCurve(amount) {\n    const n = 44100;\n    const curve = new Float32Array(n);\n    const deg = Math.PI / 180;\n\n    for (let i = 0; i < n; i++) {\n      const x = (i * 2) / n - 1;\n      if (amount === 0) {\n        curve[i] = x;\n      } else {\n        curve[i] = ((3 + amount) * x * 20 * deg) / (Math.PI + amount * Math.abs(x));\n      }\n    }\n    return curve;\n  }\n\n  setDistortionDrive(value) {\n    this.effects.distortion.drive = value;\n    this.effects.distortion.shaper.curve = this._makeDistortionCurve(value);\n    this.effects.distortion.preGain.gain.setTargetAtTime(1 + value * 0.3, this.ctx.currentTime, 0.02);\n  }\n\n  setDistortionMix(value) {\n    this.effects.distortion.wet.gain.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.effects.distortion.wetValue = value;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ PHASER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _initPhaser() {\n    // 4-stage allpass phaser con LFO\n    const phaser = {\n      stages: [],\n      lfo: this.ctx.createOscillator(),\n      lfoGain: this.ctx.createGain(),\n      wet: this.ctx.createGain(),\n      feedback: this.ctx.createGain(),\n      rate: 1,\n      depth: 0.5,\n      wetValue: 0,\n    };\n\n    phaser.wet.gain.value = 0;\n    phaser.feedback.gain.value = 0.3;\n    phaser.lfo.type = 'sine';\n    phaser.lfo.frequency.value = 1;\n    phaser.lfoGain.gain.value = 1500;\n\n    // 4 etapas de allpass filters\n    let prevNode = this.input;\n    for (let i = 0; i < 4; i++) {\n      const ap = this.ctx.createBiquadFilter();\n      ap.type = 'allpass';\n      ap.frequency.value = 1000 + i * 500;\n      ap.Q.value = 0.5;\n      prevNode.connect(ap);\n      phaser.lfo.connect(phaser.lfoGain);\n      phaser.lfoGain.connect(ap.frequency);\n      phaser.stages.push(ap);\n      prevNode = ap;\n    }\n\n    // √öltima etapa ‚Üí feedback ‚Üí primera etapa\n    prevNode.connect(phaser.feedback);\n    phaser.feedback.connect(phaser.stages[0]);\n    prevNode.connect(phaser.wet);\n    phaser.wet.connect(this.output);\n\n    phaser.lfo.start();\n\n    this.effects.phaser = phaser;\n  }\n\n  setPhaserRate(value) {\n    this.effects.phaser.lfo.frequency.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.effects.phaser.rate = value;\n  }\n\n  setPhaserDepth(value) {\n    this.effects.phaser.lfoGain.gain.setTargetAtTime(value * 3000, this.ctx.currentTime, 0.02);\n    this.effects.phaser.depth = value;\n  }\n\n  setPhaserWet(value) {\n    this.effects.phaser.wet.gain.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.effects.phaser.wetValue = value;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ CONNECT / DISCONNECT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  connect(sourceNode, destNode) {\n    sourceNode.connect(this.input);\n    this.output.connect(destNode);\n  }\n\n  disconnect() {\n    try {\n      this.input.disconnect();\n      this.output.disconnect();\n    } catch (e) { /* ya desconectado */ }\n  }\n\n  // Obtener todos los valores actuales (para serializaci√≥n)\n  getState() {\n    return {\n      reverb: { wet: this.effects.reverb.wetValue, decay: this.effects.reverb.decay },\n      delay: { time: this.effects.delay.timeValue, feedback: this.effects.delay.feedbackValue, wet: this.effects.delay.wetValue },\n      distortion: { drive: this.effects.distortion.drive, mix: this.effects.distortion.wetValue },\n      phaser: { rate: this.effects.phaser.rate, depth: this.effects.phaser.depth, wet: this.effects.phaser.wetValue },\n    };\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Master Chain ‚Äî Procesamiento profesional de se√±al\n   Compresor ‚Üí EQ param√©trico ‚Üí Limiter ‚Üí IR Convolution\n   Dynamic Spectral EQ (Soothe2 clone) + Spectral Analysis\n   \n   NIVEL DIOS DSP ‚Äî Lo que usan iZotope, FabFilter, LANDR\n   pero gratis, en el navegador\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class MasterChain {\n  constructor(audioCtx) {\n    this.ctx = audioCtx;\n    this.input = this.ctx.createGain();\n    this.output = this.ctx.createGain();\n    this.enabled = false;\n\n    // Cadena: Input ‚Üí Compressor ‚Üí ParaEQ ‚Üí Convolver ‚Üí Limiter ‚Üí Output\n    this._initCompressor();\n    this._initParametricEQ();\n    this._initConvolver();\n    this._initLimiter();\n    this._initSpectralAnalysis();\n\n    // Conectar cadena\n    this._connectChain();\n  }\n\n  // ‚îÄ‚îÄ‚îÄ COMPRESSOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  // Emulaci√≥n de compresor de bus estilo SSL G\n  _initCompressor() {\n    this.compressor = this.ctx.createDynamicsCompressor();\n    this.compressor.threshold.value = -18;\n    this.compressor.knee.value = 6;\n    this.compressor.ratio.value = 3;\n    this.compressor.attack.value = 0.003;    // 3ms ‚Äî r√°pido para transientes\n    this.compressor.release.value = 0.15;    // 150ms ‚Äî musical\n    \n    this.compressorMakeup = this.ctx.createGain();\n    this.compressorMakeup.gain.value = 1.2;  // Makeup gain autom√°tico\n\n    this.compState = {\n      threshold: -18,\n      knee: 6,\n      ratio: 3,\n      attack: 0.003,\n      release: 0.15,\n      makeupGain: 1.2,\n      enabled: true,\n    };\n  }\n\n  setCompressorParams(params) {\n    const t = this.ctx.currentTime;\n    if (params.threshold !== undefined) {\n      this.compressor.threshold.setTargetAtTime(params.threshold, t, 0.02);\n      this.compState.threshold = params.threshold;\n    }\n    if (params.knee !== undefined) {\n      this.compressor.knee.setTargetAtTime(params.knee, t, 0.02);\n      this.compState.knee = params.knee;\n    }\n    if (params.ratio !== undefined) {\n      this.compressor.ratio.setTargetAtTime(params.ratio, t, 0.02);\n      this.compState.ratio = params.ratio;\n    }\n    if (params.attack !== undefined) {\n      this.compressor.attack.setTargetAtTime(params.attack, t, 0.02);\n      this.compState.attack = params.attack;\n    }\n    if (params.release !== undefined) {\n      this.compressor.release.setTargetAtTime(params.release, t, 0.02);\n      this.compState.release = params.release;\n    }\n    if (params.makeupGain !== undefined) {\n      this.compressorMakeup.gain.setTargetAtTime(params.makeupGain, t, 0.02);\n      this.compState.makeupGain = params.makeupGain;\n    }\n  }\n\n  getCompressorReduction() {\n    return this.compressor.reduction; // dB de compresi√≥n aplicada\n  }\n\n  // ‚îÄ‚îÄ‚îÄ PARAMETRIC EQ (8 bandas) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  // EQ param√©trico de estudio: HPF, LowShelf, 4x Peaking, HighShelf, LPF\n  _initParametricEQ() {\n    this.eqBands = [];\n\n    const bandDefs = [\n      { type: 'highpass',   freq: 30,    q: 0.707, gain: 0 },  // Sub rumble filter\n      { type: 'lowshelf',   freq: 80,    q: 0.707, gain: 0 },  // Bass shelf\n      { type: 'peaking',    freq: 250,   q: 1.0,   gain: 0 },  // Low-mid\n      { type: 'peaking',    freq: 800,   q: 1.0,   gain: 0 },  // Mid\n      { type: 'peaking',    freq: 2500,  q: 1.0,   gain: 0 },  // Presence\n      { type: 'peaking',    freq: 6300,  q: 1.0,   gain: 0 },  // Brilliance\n      { type: 'highshelf',  freq: 10000, q: 0.707, gain: 0 },  // Air shelf\n      { type: 'lowpass',    freq: 18000, q: 0.707, gain: 0 },  // Anti-alias\n    ];\n\n    for (const def of bandDefs) {\n      const band = this.ctx.createBiquadFilter();\n      band.type = def.type;\n      band.frequency.value = def.freq;\n      band.Q.value = def.q;\n      if (def.type === 'peaking' || def.type === 'lowshelf' || def.type === 'highshelf') {\n        band.gain.value = def.gain;\n      }\n      this.eqBands.push({ node: band, ...def });\n    }\n  }\n\n  setEQBand(index, params) {\n    const band = this.eqBands[index];\n    if (!band) return;\n    const t = this.ctx.currentTime;\n\n    if (params.freq !== undefined) {\n      band.node.frequency.setTargetAtTime(params.freq, t, 0.02);\n      band.freq = params.freq;\n    }\n    if (params.q !== undefined) {\n      band.node.Q.setTargetAtTime(params.q, t, 0.02);\n      band.q = params.q;\n    }\n    if (params.gain !== undefined && band.node.gain) {\n      band.node.gain.setTargetAtTime(params.gain, t, 0.02);\n      band.gain = params.gain;\n    }\n    if (params.type !== undefined) {\n      band.node.type = params.type;\n      band.type = params.type;\n    }\n  }\n\n  getEQState() {\n    return this.eqBands.map(b => ({\n      type: b.type,\n      freq: b.freq,\n      q: b.q,\n      gain: b.gain,\n    }));\n  }\n\n  // ‚îÄ‚îÄ‚îÄ CONVOLUTION IR LOADER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  // Clonar hardware anal√≥gico: Studer, Neve, SSL via Impulse Response\n  _initConvolver() {\n    this.convolver = this.ctx.createConvolver();\n    this.convolverWet = this.ctx.createGain();\n    this.convolverDry = this.ctx.createGain();\n    this.convolverWet.gain.value = 0;    // Off por defecto\n    this.convolverDry.gain.value = 1;\n    this.irLoaded = false;\n    this.irName = null;\n  }\n\n  // Cargar un IR desde archivo (el usuario sube un .wav de una m√°quina anal√≥gica)\n  async loadImpulseResponse(file) {\n    try {\n      const arrayBuffer = await file.arrayBuffer();\n      const irBuffer = await this.ctx.decodeAudioData(arrayBuffer);\n      this.convolver.buffer = irBuffer;\n      this.irLoaded = true;\n      this.irName = file.name.replace(/\\.[^/.]+$/, '');\n      return {\n        name: this.irName,\n        duration: irBuffer.duration,\n        channels: irBuffer.numberOfChannels,\n        sampleRate: irBuffer.sampleRate,\n      };\n    } catch (err) {\n      console.error('Error cargando IR:', err);\n      throw new Error(`IR inv√°lido: ${err.message}`);\n    }\n  }\n\n  // Generar un IR sint√©tico de room/tape\n  async generateSyntheticIR(type = 'tape', decay = 1.5) {\n    const rate = this.ctx.sampleRate;\n    const length = Math.floor(rate * decay);\n    const buffer = this.ctx.createBuffer(2, length, rate);\n\n    for (let ch = 0; ch < 2; ch++) {\n      const data = buffer.getChannelData(ch);\n\n      switch (type) {\n        case 'tape': {\n          // Emulaci√≥n de saturaci√≥n de cinta: arm√≥nicos pares + roll-off HF\n          for (let i = 0; i < length; i++) {\n            const t = i / rate;\n            const noise = (Math.random() * 2 - 1);\n            const envelope = Math.exp(-t * 3 / decay);\n            \n            // Arm√≥nicos de cinta (2do y 3er arm√≥nico a√±adidos)\n            const harmonics = Math.sin(2 * Math.PI * 60 * t) * 0.02 +\n                            Math.sin(2 * Math.PI * 120 * t) * 0.01;\n            \n            // Roll-off natural de alta frecuencia (simulando la respuesta de cinta)\n            const hfRolloff = Math.exp(-t * 8);\n            data[i] = (noise * envelope + harmonics * hfRolloff) * 0.5;\n          }\n          break;\n        }\n        case 'room': {\n          // Room reverb con reflexiones tempranas\n          for (let i = 0; i < length; i++) {\n            const t = i / rate;\n            const noise = (Math.random() * 2 - 1);\n            const envelope = Math.exp(-t * 2 / decay);\n            \n            // Reflexiones tempranas (primeros 50ms)\n            const earlyRef = t < 0.05 ? Math.sin(t * 800) * (1 - t * 20) : 0;\n            \n            // Difusi√≥n con decorrelaci√≥n est√©reo\n            const diffusion = ch === 0 ? 1 : -0.7;\n            data[i] = (noise * envelope * diffusion + earlyRef * 0.3) * 0.3;\n          }\n          break;\n        }\n        case 'plate': {\n          // Placa met√°lica ‚Äî reverb denso y brillante\n          for (let i = 0; i < length; i++) {\n            const t = i / rate;\n            const noise = (Math.random() * 2 - 1);\n            const envelope = Math.pow(1 - t / decay, 1.5);\n            \n            // Resonancias de placa\n            const resonance = Math.sin(2 * Math.PI * 2400 * t) * 0.005 * envelope +\n                            Math.sin(2 * Math.PI * 4800 * t) * 0.003 * envelope;\n            \n            data[i] = (noise * envelope + resonance) * 0.25;\n          }\n          break;\n        }\n        case 'console': {\n          // Consola anal√≥gica SSL/Neve ‚Äî color sutil\n          for (let i = 0; i < length; i++) {\n            const t = i / rate;\n            const noise = (Math.random() * 2 - 1);\n            // Decaimiento muy r√°pido ‚Äî solo a√±ade \"color\"\n            const envelope = Math.exp(-t * 20);\n            \n            // Distorsi√≥n arm√≥nica suave (saturaci√≥n de transformadores)\n            const harmonic2 = Math.sin(2 * Math.PI * 100 * t) * 0.015;\n            const harmonic3 = Math.sin(2 * Math.PI * 150 * t) * 0.008;\n            \n            data[i] = (noise * envelope * 0.1 + (harmonic2 + harmonic3) * envelope) * 0.5;\n          }\n          break;\n        }\n        default:\n          for (let i = 0; i < length; i++) {\n            data[i] = (Math.random() * 2 - 1) * Math.exp(-i / length * decay);\n          }\n      }\n    }\n\n    this.convolver.buffer = buffer;\n    this.irLoaded = true;\n    this.irName = `Synthetic ${type}`;\n    return { name: this.irName, type, decay, duration: decay };\n  }\n\n  setConvolverWet(value) {\n    this.convolverWet.gain.setTargetAtTime(value, this.ctx.currentTime, 0.02);\n    this.convolverDry.gain.setTargetAtTime(1 - value * 0.7, this.ctx.currentTime, 0.02);\n  }\n\n  // ‚îÄ‚îÄ‚îÄ LIMITER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  // Brickwall limiter ‚Äî nunca saturar, nunca clipear\n  _initLimiter() {\n    this.limiter = this.ctx.createDynamicsCompressor();\n    this.limiter.threshold.value = -1;      // Ceiling -1 dBFS\n    this.limiter.knee.value = 0;            // Brickwall ‚Äî sin knee\n    this.limiter.ratio.value = 20;          // Ratio extremo\n    this.limiter.attack.value = 0.001;      // 1ms ‚Äî ultra r√°pido\n    this.limiter.release.value = 0.05;      // 50ms ‚Äî r√°pido release\n\n    this.limiterState = {\n      ceiling: -1,\n      enabled: true,\n    };\n  }\n\n  setLimiterCeiling(dB) {\n    this.limiter.threshold.setTargetAtTime(dB, this.ctx.currentTime, 0.01);\n    this.limiterState.ceiling = dB;\n  }\n\n  getLimiterReduction() {\n    return this.limiter.reduction;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ SPECTRAL ANALYSIS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  // An√°lisis espectral avanzado: centroide, rolloff, RMS, crest factor\n  _initSpectralAnalysis() {\n    this.analyser = this.ctx.createAnalyser();\n    this.analyser.fftSize = 4096;\n    this.analyser.smoothingTimeConstant = 0.8;\n    this._freqData = new Uint8Array(this.analyser.frequencyBinCount);\n    this._timeData = new Float32Array(this.analyser.fftSize);\n  }\n\n  getSpectralAnalysis() {\n    this.analyser.getByteFrequencyData(this._freqData);\n    this.analyser.getFloatTimeDomainData(this._timeData);\n\n    const freq = this._freqData;\n    const time = this._timeData;\n    const binCount = this.analyser.frequencyBinCount;\n    const sampleRate = this.ctx.sampleRate;\n\n    // ‚îÄ‚îÄ‚îÄ RMS (Root Mean Square) ‚Äî volumen percibido\n    let sumSquares = 0;\n    for (let i = 0; i < time.length; i++) {\n      sumSquares += time[i] * time[i];\n    }\n    const rms = Math.sqrt(sumSquares / time.length);\n    const rmsDb = 20 * Math.log10(Math.max(rms, 1e-10));\n\n    // ‚îÄ‚îÄ‚îÄ Peak level\n    let peak = 0;\n    for (let i = 0; i < time.length; i++) {\n      const abs = Math.abs(time[i]);\n      if (abs > peak) peak = abs;\n    }\n    const peakDb = 20 * Math.log10(Math.max(peak, 1e-10));\n\n    // ‚îÄ‚îÄ‚îÄ Crest Factor ‚Äî ratio peak:RMS (indica \"punch\" de los transientes)\n    const crestFactor = peak / Math.max(rms, 1e-10);\n    const crestDb = 20 * Math.log10(Math.max(crestFactor, 1e-10));\n\n    // ‚îÄ‚îÄ‚îÄ Spectral Centroid ‚Äî \"brillo\" perceptual\n    let weightedSum = 0;\n    let totalEnergy = 0;\n    for (let i = 0; i < binCount; i++) {\n      const magnitude = freq[i];\n      const frequency = (i * sampleRate) / (binCount * 2);\n      weightedSum += frequency * magnitude;\n      totalEnergy += magnitude;\n    }\n    const centroid = totalEnergy > 0 ? weightedSum / totalEnergy : 0;\n\n    // ‚îÄ‚îÄ‚îÄ Spectral Rolloff ‚Äî frecuencia donde est√° el 85% de la energ√≠a\n    const rolloffThreshold = totalEnergy * 0.85;\n    let cumulativeEnergy = 0;\n    let rolloff = 0;\n    for (let i = 0; i < binCount; i++) {\n      cumulativeEnergy += freq[i];\n      if (cumulativeEnergy >= rolloffThreshold) {\n        rolloff = (i * sampleRate) / (binCount * 2);\n        break;\n      }\n    }\n\n    // ‚îÄ‚îÄ‚îÄ Spectral Flatness ‚Äî noise vs tonal (1 = puro ruido, 0 = tono puro)\n    let geometricMean = 0;\n    let arithmeticMean = 0;\n    let validBins = 0;\n    for (let i = 1; i < binCount; i++) {\n      if (freq[i] > 0) {\n        geometricMean += Math.log(freq[i]);\n        arithmeticMean += freq[i];\n        validBins++;\n      }\n    }\n    const flatness = validBins > 0\n      ? Math.exp(geometricMean / validBins) / (arithmeticMean / validBins)\n      : 0;\n\n    // ‚îÄ‚îÄ‚îÄ LUFS estimado (simplificado ‚Äî promedio RMS ponderado)\n    const lufsEstimate = rmsDb - 0.691; // Approximaci√≥n K-weighting\n\n    return {\n      rms, rmsDb: Math.round(rmsDb * 10) / 10,\n      peak, peakDb: Math.round(peakDb * 10) / 10,\n      crestFactor: Math.round(crestFactor * 10) / 10,\n      crestDb: Math.round(crestDb * 10) / 10,\n      centroid: Math.round(centroid),\n      rolloff: Math.round(rolloff),\n      flatness: Math.round(flatness * 1000) / 1000,\n      lufsEstimate: Math.round(lufsEstimate * 10) / 10,\n      frequencyData: freq,\n    };\n  }\n\n  // ‚îÄ‚îÄ‚îÄ DYNAMIC SPECTRAL EQ (Soothe2 Clone) ‚îÄ‚îÄ\n  // Atenuaci√≥n quir√∫rgica de resonancias en tiempo real\n  // Usa un banco de filtros notch que se activan solo cuando una frecuencia\n  // supera un umbral din√°mico relativo a la media espectral\n  initDynamicSpectralEQ(options = {}) {\n    const {\n      bandCount = 16,         // N√∫mero de bandas de an√°lisis\n      threshold = 3.0,        // Cu√°ntas veces la media antes de atenuar\n      attenuation = 0.5,      // Factor de atenuaci√≥n (0.5 = -6dB)\n      attackMs = 5,           // Velocidad de ataque\n      releaseMs = 50,         // Velocidad de release\n    } = options;\n\n    this.dynEQ = {\n      enabled: false,\n      bandCount,\n      threshold,\n      attenuation,\n      attack: attackMs / 1000,\n      release: releaseMs / 1000,\n      bands: [],\n      // Running averages de energ√≠a por banda\n      avgEnergy: new Float32Array(bandCount),\n      currentGains: new Float32Array(bandCount).fill(1),\n    };\n\n    // Crear bandas de filtros notch\n    const nyquist = this.ctx.sampleRate / 2;\n    for (let i = 0; i < bandCount; i++) {\n      // Distribuci√≥n logar√≠tmica de frecuencias (100Hz - 16kHz)\n      const freq = 100 * Math.pow(16000 / 100, i / (bandCount - 1));\n      const filter = this.ctx.createBiquadFilter();\n      filter.type = 'peaking';\n      filter.frequency.value = Math.min(freq, nyquist * 0.95);\n      filter.Q.value = 2.5;  // Q moderado ‚Äî no demasiado estrecho\n      filter.gain.value = 0; // Neutro por defecto\n\n      this.dynEQ.bands.push({\n        filter,\n        freq,\n        currentGain: 0,\n      });\n    }\n\n    return this.dynEQ;\n  }\n\n  // Procesar un frame del Dynamic Spectral EQ\n  // Llamar esto en el animation loop para actualizar las bandas\n  processDynamicSpectralEQ() {\n    if (!this.dynEQ?.enabled) return;\n\n    this.analyser.getByteFrequencyData(this._freqData);\n    const data = this._freqData;\n    const binCount = this.analyser.frequencyBinCount;\n    const sampleRate = this.ctx.sampleRate;\n    const { bands, bandCount, threshold, attenuation, avgEnergy, currentGains, attack, release } = this.dynEQ;\n    const t = this.ctx.currentTime;\n\n    for (let b = 0; b < bandCount; b++) {\n      const band = bands[b];\n\n      // Encontrar energ√≠a en la banda de frecuencia correspondiente\n      const binIndex = Math.round(band.freq * binCount * 2 / sampleRate);\n      const startBin = Math.max(0, binIndex - 2);\n      const endBin = Math.min(binCount - 1, binIndex + 2);\n\n      let bandEnergy = 0;\n      for (let i = startBin; i <= endBin; i++) {\n        bandEnergy += data[i];\n      }\n      bandEnergy /= (endBin - startBin + 1);\n\n      // Actualizar media m√≥vil exponencial\n      const alpha = 0.05; // Factor de suavizado\n      avgEnergy[b] = avgEnergy[b] * (1 - alpha) + bandEnergy * alpha;\n\n      // ¬øSupera el umbral? ‚Üí Atenuar\n      const ratio = avgEnergy[b] > 0 ? bandEnergy / avgEnergy[b] : 0;\n      let targetGain = 0;\n\n      if (ratio > threshold) {\n        // Resonancia detectada ‚Äî calcular atenuaci√≥n proporcional\n        const excess = ratio - threshold;\n        targetGain = -(excess * 3 * (1 - attenuation)); // dB de atenuaci√≥n\n        targetGain = Math.max(targetGain, -12); // No atenuar m√°s de 12 dB\n      }\n\n      // Smooth hacia target con attack/release\n      const currentGain = currentGains[b];\n      const timeConstant = targetGain < currentGain ? attack : release;\n      band.filter.gain.setTargetAtTime(targetGain, t, timeConstant);\n      currentGains[b] = targetGain;\n    }\n  }\n\n  enableDynamicSpectralEQ(enable) {\n    if (!this.dynEQ) this.initDynamicSpectralEQ();\n    this.dynEQ.enabled = enable;\n\n    if (enable) {\n      // Insertar bandas en la cadena antes del limiter\n      this._reconnectWithDynEQ();\n    } else {\n      // Resetear todas las bandas\n      for (const band of this.dynEQ.bands) {\n        band.filter.gain.setTargetAtTime(0, this.ctx.currentTime, 0.05);\n      }\n    }\n  }\n\n  _reconnectWithDynEQ() {\n    // Las bandas del dynamic EQ se insertan entre el EQ param√©trico y el convolver\n    // Esto se maneja en _connectChain() cuando se reconstruye\n    this._connectChain();\n  }\n\n  // ‚îÄ‚îÄ‚îÄ CHAIN CONNECTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _connectChain() {\n    // Desconectar todo primero\n    try {\n      this.input.disconnect();\n      for (const band of this.eqBands) band.node.disconnect();\n      this.compressor.disconnect();\n      this.compressorMakeup.disconnect();\n      this.convolver.disconnect();\n      this.convolverWet.disconnect();\n      this.convolverDry.disconnect();\n      this.limiter.disconnect();\n      this.analyser.disconnect();\n      if (this.dynEQ) {\n        for (const band of this.dynEQ.bands) band.filter.disconnect();\n      }\n    } catch (e) { /* OK si no conectado */ }\n\n    // Input ‚Üí Compressor ‚Üí Makeup ‚Üí EQ Bands (en serie)\n    this.input.connect(this.compressor);\n    this.compressor.connect(this.compressorMakeup);\n\n    let lastNode = this.compressorMakeup;\n\n    // EQ param√©trico en serie\n    for (const band of this.eqBands) {\n      lastNode.connect(band.node);\n      lastNode = band.node;\n    }\n\n    // Dynamic Spectral EQ (si activo)\n    if (this.dynEQ?.enabled) {\n      for (const band of this.dynEQ.bands) {\n        lastNode.connect(band.filter);\n        lastNode = band.filter;\n      }\n    }\n\n    // Convolver (parallel wet/dry)\n    if (this.irLoaded) {\n      lastNode.connect(this.convolver);\n      lastNode.connect(this.convolverDry);\n      this.convolver.connect(this.convolverWet);\n      this.convolverWet.connect(this.limiter);\n      this.convolverDry.connect(this.limiter);\n    } else {\n      lastNode.connect(this.limiter);\n    }\n\n    // Limiter ‚Üí Analyser ‚Üí Output\n    this.limiter.connect(this.analyser);\n    this.analyser.connect(this.output);\n  }\n\n  // ‚îÄ‚îÄ‚îÄ CONNECT TO AUDIO GRAPH ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  connect(sourceNode, destNode) {\n    sourceNode.connect(this.input);\n    this.output.connect(destNode);\n    this.enabled = true;\n  }\n\n  disconnect() {\n    try {\n      this.input.disconnect();\n      this.output.disconnect();\n    } catch (e) { /* OK */ }\n    this.enabled = false;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ SERIALIZE STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  getState() {\n    return {\n      compressor: { ...this.compState },\n      eq: this.getEQState(),\n      convolver: {\n        irName: this.irName,\n        irLoaded: this.irLoaded,\n        wet: this.convolverWet.gain.value,\n      },\n      limiter: { ...this.limiterState },\n      dynamicEQ: this.dynEQ ? {\n        enabled: this.dynEQ.enabled,\n        threshold: this.dynEQ.threshold,\n        attenuation: this.dynEQ.attenuation,\n        bandCount: this.dynEQ.bandCount,\n      } : null,\n    };\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Timeline ‚Äî Editor visual de tracks con regiones\n   Drag & drop, zoom, playhead, automix ordering\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nimport { AudioEngine } from '../audio/audio-engine.js';\n\nexport class Timeline {\n  constructor(container, rulerCanvas) {\n    this.container = container;\n    this.tracksEl = container.querySelector('#timeline-tracks') || container;\n    this.rulerCanvas = rulerCanvas;\n    this.rulerCtx = rulerCanvas?.getContext('2d');\n    this.playheadEl = container.querySelector('#timeline-playhead');\n\n    this.tracks = [];\n    this.zoom = 1; // pixels per second\n    this.pxPerSecond = 80;\n    this.scrollLeft = 0;\n    this.trackHeight = 64;\n    this.labelWidth = 120;\n\n    this._setupRuler();\n  }\n\n  // A√±adir un track al timeline\n  addTrack(track) {\n    const trackData = {\n      id: track.name || `Track ${this.tracks.length + 1}`,\n      name: track.name,\n      duration: track.duration,\n      bpm: track.bpm,\n      key: track.key,\n      camelot: track.camelot,\n      waveformData: track.waveformData,\n      startTime: this._getNextStartTime(),\n      color: this.tracks.length % 2 === 0 ? '#CCFF00' : '#6600FF',\n    };\n\n    this.tracks.push(trackData);\n    this._renderTrack(trackData, this.tracks.length - 1);\n    this._updateRuler();\n    return trackData;\n  }\n\n  _getNextStartTime() {\n    if (this.tracks.length === 0) return 0;\n    const lastTrack = this.tracks[this.tracks.length - 1];\n    // Overlap de 15 segundos por defecto para crossfade\n    return Math.max(0, lastTrack.startTime + lastTrack.duration - 15);\n  }\n\n  _renderTrack(track, index) {\n    const effectivePxPerSec = this.pxPerSecond * this.zoom;\n    const trackEl = document.createElement('div');\n    trackEl.className = 'timeline-track';\n    trackEl.dataset.index = index;\n\n    // Label\n    const label = document.createElement('div');\n    label.className = 'timeline-track-label';\n    label.innerHTML = `\n      <span style=\"color: ${track.color}; font-weight: 700;\">‚óè</span>\n      <span>${track.name || `Track ${index + 1}`}</span>\n    `;\n\n    // Contenido\n    const content = document.createElement('div');\n    content.className = 'timeline-track-content';\n\n    // Regi√≥n del track\n    const region = document.createElement('div');\n    region.className = 'timeline-region';\n    region.style.left = `${track.startTime * effectivePxPerSec}px`;\n    region.style.width = `${track.duration * effectivePxPerSec}px`;\n    region.style.background = `linear-gradient(180deg, ${track.color}20 0%, ${track.color}05 100%)`;\n    region.style.border = `1px solid ${track.color}60`;\n    region.style.boxShadow = `0 0 10px ${track.color}10`;\n    region.style.borderRadius = '2px';\n\n    // Nombre de la regi√≥n\n    const regionName = document.createElement('div');\n    regionName.className = 'region-name';\n    regionName.textContent = track.name;\n    regionName.style.color = track.color;\n\n    // Mini waveform en la regi√≥n\n    const miniCanvas = document.createElement('canvas');\n    miniCanvas.width = Math.max(1, Math.floor(track.duration * effectivePxPerSec));\n    miniCanvas.height = 40;\n    this._drawMiniWaveform(miniCanvas, track.waveformData, track.color);\n\n    region.appendChild(regionName);\n    region.appendChild(miniCanvas);\n    content.appendChild(region);\n\n    // Drag & drop para reordenar\n    this._makeDraggable(region, track, effectivePxPerSec);\n\n    trackEl.appendChild(label);\n    trackEl.appendChild(content);\n    this.tracksEl.appendChild(trackEl);\n\n    // Actualizar ancho total del timeline\n    this._updateTotalWidth();\n  }\n\n  _drawMiniWaveform(canvas, data, color) {\n    if (!data) return;\n    const ctx = canvas.getContext('2d');\n    const width = canvas.width;\n    const height = canvas.height;\n    const centerY = height / 2;\n\n    ctx.clearRect(0, 0, width, height);\n    ctx.fillStyle = color + '60';\n\n    const step = data.length / width;\n    for (let x = 0; x < width; x++) {\n      const idx = Math.floor(x * step);\n      const amplitude = (data[idx] || 0) * centerY * 0.95;\n      \n      // Mirror effect for sovereign look\n      ctx.globalAlpha = 0.8;\n      ctx.fillRect(x, centerY - amplitude, 1, amplitude);\n      ctx.globalAlpha = 0.4;\n      ctx.fillRect(x, centerY, 1, amplitude);\n    }\n  }\n\n  _makeDraggable(element, track, pxPerSec) {\n    let isDragging = false;\n    let startX = 0;\n    let originalLeft = 0;\n\n    element.addEventListener('mousedown', (e) => {\n      isDragging = true;\n      startX = e.clientX;\n      originalLeft = parseFloat(element.style.left) || 0;\n      element.style.cursor = 'grabbing';\n      e.preventDefault();\n    });\n\n    document.addEventListener('mousemove', (e) => {\n      if (!isDragging) return;\n      const dx = e.clientX - startX;\n      const newLeft = Math.max(0, originalLeft + dx);\n      element.style.left = `${newLeft}px`;\n      track.startTime = newLeft / pxPerSec;\n    });\n\n    document.addEventListener('mouseup', () => {\n      if (!isDragging) return;\n      isDragging = false;\n      element.style.cursor = 'grab';\n    });\n  }\n\n  // Actualizar ancho total basado en contenido\n  _updateTotalWidth() {\n    const effectivePxPerSec = this.pxPerSecond * this.zoom;\n    let maxEnd = 0;\n    for (const track of this.tracks) {\n      const end = (track.startTime + track.duration) * effectivePxPerSec;\n      if (end > maxEnd) maxEnd = end;\n    }\n    this.tracksEl.style.width = `${this.labelWidth + maxEnd + 200}px`;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ RULER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _setupRuler() {\n    if (!this.rulerCanvas) return;\n    const resizeObserver = new ResizeObserver(() => this._updateRuler());\n    resizeObserver.observe(this.rulerCanvas.parentElement || this.rulerCanvas);\n  }\n\n  _updateRuler() {\n    if (!this.rulerCanvas || !this.rulerCtx) return;\n\n    const effectivePxPerSec = this.pxPerSecond * this.zoom;\n    const totalWidth = this.tracksEl?.offsetWidth || 2000;\n\n    const dpr = window.devicePixelRatio || 1;\n    this.rulerCanvas.width = totalWidth * dpr;\n    this.rulerCanvas.height = 24 * dpr;\n    this.rulerCanvas.style.width = `${totalWidth}px`;\n    this.rulerCtx.scale(dpr, dpr);\n\n    const ctx = this.rulerCtx;\n    ctx.fillStyle = '#111111';\n    ctx.fillRect(0, 0, totalWidth, 24);\n\n    // Marcas de tiempo\n    const interval = this.zoom < 0.5 ? 10 : this.zoom < 1 ? 5 : this.zoom < 2 ? 2 : 1;\n\n    ctx.fillStyle = '#666';\n    ctx.font = '10px \"JetBrains Mono\", monospace';\n    ctx.textAlign = 'center';\n\n    for (let sec = 0; sec < totalWidth / effectivePxPerSec; sec += interval) {\n      const x = this.labelWidth + sec * effectivePxPerSec;\n\n      // Marca principal\n      ctx.strokeStyle = '#333';\n      ctx.lineWidth = 1;\n      ctx.beginPath();\n      ctx.moveTo(x, 16);\n      ctx.lineTo(x, 24);\n      ctx.stroke();\n\n      // Tiempo\n      const min = Math.floor(sec / 60);\n      const s = Math.floor(sec % 60);\n      ctx.fillText(`${min}:${s.toString().padStart(2, '0')}`, x, 12);\n    }\n  }\n\n  // ‚îÄ‚îÄ‚îÄ ZOOM ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  setZoom(level) {\n    this.zoom = Math.max(0.1, Math.min(4, level));\n    this._rerender();\n    return this.zoom;\n  }\n\n  zoomIn() { return this.setZoom(this.zoom * 1.25); }\n  zoomOut() { return this.setZoom(this.zoom / 1.25); }\n\n  _rerender() {\n    this.tracksEl.innerHTML = '';\n    this.tracks.forEach((track, i) => this._renderTrack(track, i));\n    this._updateRuler();\n  }\n\n  // ‚îÄ‚îÄ‚îÄ PLAYHEAD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  updatePlayhead(currentTime) {\n    if (!this.playheadEl) return;\n    const effectivePxPerSec = this.pxPerSecond * this.zoom;\n    const x = this.labelWidth + currentTime * effectivePxPerSec;\n    this.playheadEl.style.left = `${x}px`;\n  }\n\n  // ‚îÄ‚îÄ‚îÄ AUTOMIX ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  automix() {\n    if (this.tracks.length < 2) return this.tracks;\n\n    // Ordenar por compatibilidad arm√≥nica + BPM proximity\n    const sorted = [this.tracks[0]];\n    const remaining = [...this.tracks.slice(1)];\n\n    while (remaining.length > 0) {\n      const last = sorted[sorted.length - 1];\n      let bestIdx = 0;\n      let bestScore = -1;\n\n      for (let i = 0; i < remaining.length; i++) {\n        const candidate = remaining[i];\n\n        // Score arm√≥nico (Camelot Wheel)\n        const harmonicScore = AudioEngine.getHarmonicScore(last.camelot, candidate.camelot);\n\n        // Score BPM (menor diferencia = mejor)\n        const bpmDiff = Math.abs(last.bpm - candidate.bpm);\n        const bpmScore = Math.max(0, 100 - bpmDiff * 5);\n\n        // Score combinado\n        const totalScore = harmonicScore * 0.6 + bpmScore * 0.4;\n\n        if (totalScore > bestScore) {\n          bestScore = totalScore;\n          bestIdx = i;\n        }\n      }\n\n      sorted.push(remaining.splice(bestIdx, 1)[0]);\n    }\n\n    // Recalcular start times\n    sorted.forEach((track, i) => {\n      if (i === 0) {\n        track.startTime = 0;\n      } else {\n        const prev = sorted[i - 1];\n        track.startTime = prev.startTime + prev.duration - 15;\n      }\n    });\n\n    this.tracks = sorted;\n    this._rerender();\n    return this.tracks;\n  }\n\n  // Obtener duraci√≥n total del mix\n  getTotalDuration() {\n    if (this.tracks.length === 0) return 0;\n    let maxEnd = 0;\n    for (const track of this.tracks) {\n      const end = track.startTime + track.duration;\n      if (end > maxEnd) maxEnd = end;\n    }\n    return maxEnd;\n  }\n\n  // Obtener tracklist formateada\n  getTrackList() {\n    return this.tracks.map((track, i) => {\n      const min = Math.floor(track.startTime / 60);\n      const sec = Math.floor(track.startTime % 60);\n      return `${i + 1}. [${min}:${sec.toString().padStart(2, '0')}] ${track.name} (${track.bpm} BPM, ${track.key})`;\n    }).join('\\n');\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Visualizer v2 ‚Äî Circular Audio Reactive GOD MODE\n   Canvas 2D con part√≠culas, spectrum bars, osciloscopio,\n   glow reactivo, y trail effect\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class Visualizer {\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d');\n    this.animFrame = null;\n    this.getFreqData = null;\n    this.getTimeData = null;\n    this.particles = [];\n    this.time = 0;\n\n    this._resize();\n    this._resizeObserver = new ResizeObserver(() => this._resize());\n    this._resizeObserver.observe(canvas);\n  }\n\n  _resize() {\n    const size = Math.min(this.canvas.clientWidth, this.canvas.clientHeight);\n    const dpr = window.devicePixelRatio || 1;\n    this.canvas.width = size * dpr;\n    this.canvas.height = size * dpr;\n    this.width = size;\n    this.height = size;\n    this.ctx.scale(dpr, dpr);\n  }\n\n  start(getFreqData, getTimeData) {\n    this.getFreqData = getFreqData;\n    this.getTimeData = getTimeData;\n    if (this.animFrame) return;\n    this._animate();\n  }\n\n  stop() {\n    if (this.animFrame) {\n      cancelAnimationFrame(this.animFrame);\n      this.animFrame = null;\n    }\n  }\n\n  _animate() {\n    const freqData = this.getFreqData?.();\n    const timeData = this.getTimeData?.();\n    this._draw(freqData, timeData);\n    this.animFrame = requestAnimationFrame(() => this._animate());\n  }\n\n  _draw(freqData, timeData) {\n    const { ctx, width, height } = this;\n    const centerX = width / 2;\n    const centerY = height / 2;\n    const radius = Math.min(width, height) * 0.32;\n\n    this.time += 0.016;\n\n    // Trail effect ‚Äî semi-transparente\n    ctx.fillStyle = 'rgba(5, 5, 7, 0.15)';\n    ctx.fillRect(0, 0, width, height);\n\n    if (!freqData || !timeData) {\n      // Estado idle ‚Äî pulso de respiraci√≥n\n      this._drawIdlePulse(centerX, centerY, radius);\n      return;\n    }\n\n    // Calcular energ√≠a promedio\n    let avgEnergy = 0;\n    let bassEnergy = 0;\n    for (let i = 0; i < freqData.length; i++) {\n      avgEnergy += freqData[i];\n      if (i < freqData.length * 0.1) bassEnergy += freqData[i];\n    }\n    avgEnergy /= freqData.length * 255;\n    bassEnergy /= (freqData.length * 0.1) * 255;\n\n    // ‚îÄ‚îÄ‚îÄ 1. GLOW DE FONDO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    const glowRadius = radius * (1.2 + avgEnergy * 0.8);\n    const gradient = ctx.createRadialGradient(\n      centerX, centerY, radius * 0.1,\n      centerX, centerY, glowRadius\n    );\n    gradient.addColorStop(0, `rgba(204, 255, 0, ${avgEnergy * 0.2})`);\n    gradient.addColorStop(0.4, `rgba(123, 47, 255, ${avgEnergy * 0.12})`);\n    gradient.addColorStop(0.7, `rgba(0, 229, 255, ${avgEnergy * 0.05})`);\n    gradient.addColorStop(1, 'transparent');\n    ctx.fillStyle = gradient;\n    ctx.fillRect(0, 0, width, height);\n\n    // ‚îÄ‚îÄ‚îÄ 2. ANILLO EXTERIOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, radius + 2, 0, Math.PI * 2);\n    ctx.strokeStyle = `rgba(204, 255, 0, ${0.08 + avgEnergy * 0.15})`;\n    ctx.lineWidth = 1;\n    ctx.stroke();\n\n    // ‚îÄ‚îÄ‚îÄ 3. BARRAS CIRCULARES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    const bars = 48;\n    const step = Math.floor(freqData.length / bars);\n    const angleStep = (Math.PI * 2) / bars;\n\n    for (let i = 0; i < bars; i++) {\n      const value = freqData[i * step] / 255;\n      const barLength = value * radius * 0.65;\n      const angle = i * angleStep - Math.PI / 2;\n\n      const x1 = centerX + Math.cos(angle) * (radius * 0.4);\n      const y1 = centerY + Math.sin(angle) * (radius * 0.4);\n      const x2 = centerX + Math.cos(angle) * (radius * 0.4 + barLength);\n      const y2 = centerY + Math.sin(angle) * (radius * 0.4 + barLength);\n\n      // Color por frecuencia: verde ‚Üí violeta ‚Üí cyan\n      const hue = 65 + (i / bars) * 240;\n      const lightness = 45 + value * 35;\n      const alpha = 0.3 + value * 0.7;\n\n      ctx.beginPath();\n      ctx.moveTo(x1, y1);\n      ctx.lineTo(x2, y2);\n      ctx.strokeStyle = `hsla(${hue}, 90%, ${lightness}%, ${alpha})`;\n      ctx.lineWidth = 2 + value * 2;\n      ctx.lineCap = 'round';\n      ctx.stroke();\n\n      // Glow en las puntas de alta energ√≠a\n      if (value > 0.7) {\n        ctx.beginPath();\n        ctx.arc(x2, y2, 2 + value * 3, 0, Math.PI * 2);\n        ctx.fillStyle = `hsla(${hue}, 100%, 70%, ${(value - 0.7) * 3})`;\n        ctx.fill();\n      }\n    }\n\n    // ‚îÄ‚îÄ‚îÄ 4. OSCILOSCOPIO INTERIOR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    ctx.beginPath();\n    const oscRadius = radius * 0.35;\n    for (let i = 0; i < timeData.length; i++) {\n      const value = (timeData[i] / 128) - 1;\n      const angle = (i / timeData.length) * Math.PI * 2 - Math.PI / 2;\n      const r = oscRadius + value * oscRadius * 0.4;\n      const x = centerX + Math.cos(angle) * r;\n      const y = centerY + Math.sin(angle) * r;\n\n      if (i === 0) ctx.moveTo(x, y);\n      else ctx.lineTo(x, y);\n    }\n    ctx.closePath();\n    ctx.strokeStyle = `rgba(0, 229, 255, ${0.3 + avgEnergy * 0.5})`;\n    ctx.lineWidth = 1.5;\n    ctx.stroke();\n\n    // Fill interior sutil\n    ctx.fillStyle = `rgba(0, 229, 255, ${avgEnergy * 0.03})`;\n    ctx.fill();\n\n    // ‚îÄ‚îÄ‚îÄ 5. RESPIRACI√ìN CENTRAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    const breathRadius = radius * 0.08 * (1 + Math.sin(this.time * 2) * 0.3 + bassEnergy * 0.5);\n    const centerGrad = ctx.createRadialGradient(\n      centerX, centerY, 0,\n      centerX, centerY, breathRadius\n    );\n    centerGrad.addColorStop(0, `rgba(204, 255, 0, ${0.5 + bassEnergy * 0.5})`);\n    centerGrad.addColorStop(0.5, `rgba(123, 47, 255, ${0.2 + bassEnergy * 0.3})`);\n    centerGrad.addColorStop(1, 'transparent');\n    ctx.fillStyle = centerGrad;\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, breathRadius, 0, Math.PI * 2);\n    ctx.fill();\n\n    // ‚îÄ‚îÄ‚îÄ 6. PART√çCULAS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    this._updateParticles(centerX, centerY, radius, bassEnergy);\n    this._drawParticles();\n  }\n\n  _drawIdlePulse(cx, cy, r) {\n    const { ctx } = this;\n    const pulse = 0.5 + Math.sin(this.time * 1.5) * 0.3;\n\n    // Anillo pulsante\n    ctx.beginPath();\n    ctx.arc(cx, cy, r * pulse, 0, Math.PI * 2);\n    ctx.strokeStyle = `rgba(204, 255, 0, ${0.1 + pulse * 0.1})`;\n    ctx.lineWidth = 1;\n    ctx.stroke();\n\n    // Centro\n    const grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, r * 0.15);\n    grad.addColorStop(0, `rgba(204, 255, 0, ${0.15 + pulse * 0.1})`);\n    grad.addColorStop(1, 'transparent');\n    ctx.fillStyle = grad;\n    ctx.beginPath();\n    ctx.arc(cx, cy, r * 0.15, 0, Math.PI * 2);\n    ctx.fill();\n  }\n\n  _updateParticles(cx, cy, r, energy) {\n    // Generar nuevas part√≠culas basadas en energ√≠a\n    if (energy > 0.5 && Math.random() < energy * 0.5) {\n      const angle = Math.random() * Math.PI * 2;\n      this.particles.push({\n        x: cx + Math.cos(angle) * r * 0.4,\n        y: cy + Math.sin(angle) * r * 0.4,\n        vx: Math.cos(angle) * (1 + energy * 3),\n        vy: Math.sin(angle) * (1 + energy * 3),\n        life: 1,\n        decay: 0.01 + Math.random() * 0.02,\n        size: 1 + Math.random() * 2,\n        hue: 65 + Math.random() * 200,\n      });\n    }\n\n    // Actualizar\n    for (let i = this.particles.length - 1; i >= 0; i--) {\n      const p = this.particles[i];\n      p.x += p.vx;\n      p.y += p.vy;\n      p.life -= p.decay;\n      p.vx *= 0.98;\n      p.vy *= 0.98;\n\n      if (p.life <= 0) {\n        this.particles.splice(i, 1);\n      }\n    }\n\n    // Limitar part√≠culas\n    if (this.particles.length > 80) {\n      this.particles.splice(0, this.particles.length - 80);\n    }\n  }\n\n  _drawParticles() {\n    const { ctx } = this;\n    for (const p of this.particles) {\n      ctx.beginPath();\n      ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);\n      ctx.fillStyle = `hsla(${p.hue}, 100%, 65%, ${p.life * 0.7})`;\n      ctx.fill();\n    }\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Exporter ‚Äî Offline rendering y descarga WAV\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class Exporter {\n  constructor() {\n    this.isExporting = false;\n    this.progress = 0;\n  }\n\n  // Export mix como WAV usando OfflineAudioContext\n  async exportWAV(audioEngine, timeline, onProgress) {\n    if (this.isExporting) return null;\n    this.isExporting = true;\n    this.progress = 0;\n\n    const totalDuration = timeline.getTotalDuration();\n    if (totalDuration <= 0) {\n      this.isExporting = false;\n      throw new Error('No hay tracks en el timeline');\n    }\n\n    const sampleRate = 44100;\n    const channels = 2;\n    const frameCount = Math.ceil(totalDuration * sampleRate);\n\n    // Crear OfflineAudioContext\n    const offlineCtx = new OfflineAudioContext(channels, frameCount, sampleRate);\n\n    // Renderizar cada track con su posici√≥n en el timeline\n    for (let i = 0; i < timeline.tracks.length; i++) {\n      const track = timeline.tracks[i];\n      const deck = track.name === audioEngine.decks.A.name\n        ? audioEngine.decks.A\n        : audioEngine.decks.B;\n\n      if (!deck || !deck.buffer) continue;\n\n      // Crear source para este track\n      const source = offlineCtx.createBufferSource();\n      source.buffer = deck.buffer;\n\n      // Gain node individual\n      const gain = offlineCtx.createGain();\n      gain.gain.value = 1;\n\n      // Crossfade: fade in y fade out de 5 segundos\n      const fadeTime = 5;\n      const startTime = track.startTime;\n\n      // Fade in\n      gain.gain.setValueAtTime(0, startTime);\n      gain.gain.linearRampToValueAtTime(1, startTime + fadeTime);\n\n      // Fade out\n      const endTime = startTime + track.duration;\n      gain.gain.setValueAtTime(1, Math.max(startTime + fadeTime, endTime - fadeTime));\n      gain.gain.linearRampToValueAtTime(0, endTime);\n\n      source.connect(gain);\n      gain.connect(offlineCtx.destination);\n      source.start(startTime);\n\n      onProgress?.((i + 1) / timeline.tracks.length * 50);\n    }\n\n    // Render\n    onProgress?.(50);\n    const renderedBuffer = await offlineCtx.startRendering();\n    onProgress?.(80);\n\n    // Convertir a WAV\n    const wavBlob = this._bufferToWav(renderedBuffer);\n    onProgress?.(95);\n\n    this.isExporting = false;\n    this.progress = 100;\n    onProgress?.(100);\n\n    return wavBlob;\n  }\n\n  // Convertir AudioBuffer a WAV Blob\n  _bufferToWav(buffer) {\n    const numOfChan = buffer.numberOfChannels;\n    const length = buffer.length * numOfChan * 2;\n    const bufferArr = new ArrayBuffer(44 + length);\n    const view = new DataView(bufferArr);\n\n    // WAV Header\n    this._writeString(view, 0, 'RIFF');\n    view.setUint32(4, 36 + length, true);\n    this._writeString(view, 8, 'WAVE');\n    this._writeString(view, 12, 'fmt ');\n    view.setUint32(16, 16, true);         // chunk size\n    view.setUint16(20, 1, true);          // PCM format\n    view.setUint16(22, numOfChan, true);  // channels\n    view.setUint32(24, buffer.sampleRate, true);\n    view.setUint32(28, buffer.sampleRate * numOfChan * 2, true); // byte rate\n    view.setUint16(32, numOfChan * 2, true); // block align\n    view.setUint16(34, 16, true);         // bits per sample\n    this._writeString(view, 36, 'data');\n    view.setUint32(40, length, true);\n\n    // Interleave samples\n    const channels = [];\n    for (let i = 0; i < numOfChan; i++) {\n      channels.push(buffer.getChannelData(i));\n    }\n\n    let offset = 44;\n    for (let i = 0; i < buffer.length; i++) {\n      for (let ch = 0; ch < numOfChan; ch++) {\n        const sample = Math.max(-1, Math.min(1, channels[ch][i]));\n        view.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);\n        offset += 2;\n      }\n    }\n\n    return new Blob([bufferArr], { type: 'audio/wav' });\n  }\n\n  _writeString(view, offset, string) {\n    for (let i = 0; i < string.length; i++) {\n      view.setUint8(offset + i, string.charCodeAt(i));\n    }\n  }\n\n  // Generar tracklist como texto\n  static generateTrackList(timeline) {\n    const tracks = timeline.tracks;\n    const lines = [\n      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',\n      '  MIXCRAFT ‚Äî Track List',\n      '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê',\n      '',\n    ];\n\n    tracks.forEach((track, i) => {\n      const min = Math.floor(track.startTime / 60);\n      const sec = Math.floor(track.startTime % 60);\n      lines.push(`${(i + 1).toString().padStart(2, '0')}. [${min}:${sec.toString().padStart(2, '0')}] ${track.name}`);\n      lines.push(`    ${track.bpm} BPM | ${track.key} | ${track.camelot}`);\n      lines.push('');\n    });\n\n    lines.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');\n    lines.push(`  Mixed with MIXCRAFT v1`);\n    lines.push('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');\n\n    return lines.join('\\n');\n  }\n\n  // Descargar archivo\n  static download(blob, filename) {\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    a.click();\n    URL.revokeObjectURL(url);\n  }\n\n  // Descargar tracklist como TXT\n  static downloadTrackList(timeline) {\n    const text = Exporter.generateTrackList(timeline);\n    const blob = new Blob([text], { type: 'text/plain' });\n    Exporter.download(blob, 'mixcraft-tracklist.txt');\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Transport Component ‚Äî Temporal Control\n   Neon-reactive buttons, BPM, Playhead\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class Transport {\n  constructor(app) {\n    this.app = app;\n    this.dom = {};\n  }\n\n  init() {\n    this._cacheDOM();\n    this._bindEvents();\n    this.render();\n  }\n\n  _cacheDOM() {\n    // Assumes new HTML structure or binds to existing\n    this.dom.playBtn = document.getElementById('transport-play');\n    this.dom.recBtn = document.getElementById('transport-rec');\n    this.dom.timeDisplay = document.querySelector('.time-display');\n    this.dom.bpmValue = document.querySelector('.bpm-value');\n    this.dom.bpmTap = document.getElementById('bpm-tap');\n  }\n\n  _bindEvents() {\n    if(this.dom.playBtn) {\n        this.dom.playBtn.addEventListener('click', () => this.app.togglePlayback());\n    }\n    \n    // Spacebar mapping\n    document.addEventListener('keydown', (e) => {\n      if (e.code === 'Space' && e.target.tagName !== 'INPUT') {\n        e.preventDefault();\n        this.app.togglePlayback();\n      }\n    });\n\n    if (this.dom.recBtn) {\n        this.dom.recBtn.addEventListener('click', () => this.app.toggleRecording());\n    }\n  }\n\n  update() {\n    // Visual Pulse for Play Button\n    if (this.app.audioEngine.isPlaying) {\n      this.dom.playBtn?.classList.add('playing');\n    } else {\n      this.dom.playBtn?.classList.remove('playing');\n    }\n\n    // Time Display\n    if (this.dom.timeDisplay) {\n        const time = this.app.audioEngine.getCurrentTime();\n        this.dom.timeDisplay.innerHTML = this._formatTime(time);\n    }\n  }\n\n  render() {\n    // Initial static render if not already in HTML\n    // For MVP, we assume HTML exists, but we can enhance element classes\n  }\n\n  _formatTime(time) {\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    const ms = Math.floor((time % 1) * 100);\n    \n    return `\n      <span>${minutes.toString().padStart(2, '0')}</span>\n      <span class=\"time-sep\">:</span>\n      <span>${seconds.toString().padStart(2, '0')}</span>\n      <span class=\"time-sep\" style=\"opacity:0.5\">.</span>\n      <span class=\"dim\">${ms.toString().padStart(2, '0')}</span>\n    `;\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   Mixer Component ‚Äî The Console\n   Channel Strips, Master Chain UI, Metering\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class Mixer {\n  constructor(app) {\n    this.app = app;\n    this.masterChain = app.audioEngine.masterChain;\n    this.dom = {};\n  }\n\n  init() {\n    this._setupMasterChainUI();\n    this._setupCrossfader();\n  }\n\n  _setupMasterChainUI() {\n    const mc = document.getElementById('master-channel');\n    if (!mc) return;\n\n    // Compressor Controls\n    this._bindKnob('#mc-comp-thresh', (v) => this.masterChain?.setCompressorParams({ threshold: parseFloat(v) }));\n    this._bindKnob('#mc-comp-ratio', (v) => this.masterChain?.setCompressorParams({ ratio: parseFloat(v) }));\n    \n    // EQ Controls (Mid/High/Air)\n    // Dynamic binding for sovereign control\n    this._bindKnob('#mc-eq-low', (v) => this.masterChain?.setEQParams({ low: parseFloat(v) }));\n    this._bindKnob('#mc-eq-mid', (v) => this.masterChain?.setEQParams({ mid: parseFloat(v) }));\n    this._bindKnob('#mc-eq-high', (v) => this.masterChain?.setEQParams({ high: parseFloat(v) }));\n    \n    // Gain Makeup\n    this._bindKnob('#mc-gain', (v) => this.masterChain?.setGain(parseFloat(v)));\n  }\n\n  _setupCrossfader() {\n    const cf = document.getElementById('crossfader');\n    if (cf) {\n      cf.addEventListener('input', (e) => {\n        const val = parseFloat(e.target.value);\n        this.app.audioEngine.setCrossfade(val);\n      });\n    }\n  }\n\n  _bindKnob(selector, callback) {\n    const el = document.querySelector(selector);\n    if (!el) return;\n    \n    el.addEventListener('input', (e) => {\n      callback(e.target.value);\n      // Update adjacent label value if exists\n      const label = el.parentElement.querySelector('.knob-val');\n      if (label) label.textContent = e.target.value;\n    });\n  }\n\n  update(analysisData) {\n    if (!analysisData) return;\n    \n    // Update Master Meters\n    const { rmsDb, peakDb, lufsEstimate } = analysisData;\n    \n    this._updateMeter('master-l', rmsDb, peakDb); \n    this._updateMeter('master-r', rmsDb, peakDb); // Duplicate for mono analysis for now\n    \n    // Update LUFS display\n    const lufsDisplay = document.getElementById('mc-lufs-val');\n    if (lufsDisplay) lufsDisplay.textContent = lufsEstimate.toFixed(1);\n    \n    // Update Compression Reduction Meter (Simulated for visuals if node doesn't support reduction property)\n    // In a real sovereign audio engine, we'd use an AudioWorklet to measure reduction.\n    // For now, we simulate visual feedback based on threshold breach.\n    const reduction = this._simulateReduction(rmsDb);\n    this._updateReductionMeter(reduction);\n  }\n\n  _simulateReduction(rmsDb) {\n    // Simple visual simulation: if RMS > Threshold, show reduction\n    if (!this.masterChain || !this.masterChain.compressor) return 0;\n    const thresh = this.masterChain.compressor.threshold.value;\n    const ratio = this.masterChain.compressor.ratio.value;\n    \n    if (rmsDb > thresh) {\n       const over = rmsDb - thresh;\n       return over * (1 - 1/ratio); // Approx reduction in dB\n    }\n    return 0;\n  }\n\n  _updateReductionMeter(reductionDb) {\n    const meter = document.getElementById('mc-comp-reduction');\n    if (!meter) return;\n    const fill = meter.querySelector('.meter-fill');\n    if (fill) {\n       // Reduction is usually 0 to -20dB. Visual scale 0-100%\n       const height = Math.min(100, (reductionDb / 20) * 100);\n       fill.style.height = `${height}%`;\n       fill.style.opacity = height > 0 ? 1 : 0.2;\n    }\n  }\n\n  _updateMeter(id, rmsDb, peakDb) {\n    // Map db -60 to 0 to 0-100%\n    // Simple mapping for visual\n    const meter = document.getElementById(id);\n    if (!meter) return;\n    \n    const fill = meter.querySelector('.meter-fill');\n    if (fill) {\n      const db = Math.max(-60, rmsDb);\n      const pct = ((db + 60) / 60) * 100;\n      fill.style.height = `${pct}%`;\n      \n      // Color logic could be here or CSS\n    }\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   FXRack Component ‚Äî Effect Units\n   Drag & Drop Slots, Parameter Visualization\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class FXRack {\n  constructor(app) {\n    this.app = app;\n    this.fxEngine = app.audioEngine.fxEngine; // Access via audio engine\n  }\n\n  init() {\n    this._setupControls();\n  }\n\n  _setupControls() {\n    // Reverb\n    this._bindFXControl('reverb-wet', (v) => this.fxEngine.setReverbWet(v));\n    this._bindFXControl('reverb-decay', (v) => this.fxEngine.setReverbDecay(v));\n\n    // Delay\n    this._bindFXControl('delay-time', (v) => this.fxEngine.setDelayTime(v));\n    this._bindFXControl('delay-feedback', (v) => this.fxEngine.setDelayFeedback(v));\n    this._bindFXControl('delay-wet', (v) => this.fxEngine.setDelayWet(v));\n\n    // Filter\n    this._bindFXControl('filter-freq', (v) => this.fxEngine.setFilterFreq(v));\n    this._bindFXControl('filter-res', (v) => this.fxEngine.setFilterResonance(v));\n\n    // Distortion\n    this._bindFXControl('dist-drive', (v) => this.fxEngine.setDistortionDrive(v));\n    this._bindFXControl('dist-mix', (v) => this.fxEngine.setDistortionMix(v));\n\n    // Power Toggles\n    document.querySelectorAll('.fx-power').forEach(btn => {\n      btn.addEventListener('click', (e) => {\n        const type = e.target.dataset.fx;\n        const isActive = e.target.classList.contains('on');\n        \n        if (isActive) {\n          e.target.classList.remove('on');\n          // Logic to bypass FX in engine\n          if (type === 'filter') this.fxEngine.toggleFilter(false);\n          // For wet/dry effects, usually setting wet to 0 effectively bypasses, \n          // but a true bypass might be needed in AudioEngine\n        } else {\n          e.target.classList.add('on');\n          if (type === 'filter') this.fxEngine.toggleFilter(true);\n        }\n      });\n    });\n  }\n\n  _bindFXControl(idSuffix, callback) {\n    const el = document.getElementById(`fx-${idSuffix}`);\n    if (!el) return;\n    \n    el.addEventListener('input', (e) => {\n      const val = parseFloat(e.target.value);\n      callback(val);\n      \n      // Visual update for value label\n      const label = el.parentElement.querySelector('.knob-val');\n      if (label) label.textContent = val.toFixed(2);\n    });\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   UIManager v1 ‚Äî Sovereign Interface Orchestrator\n   Central command for EuskAI Mixer DOM & Visuals\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nimport { Transport } from './components/Transport.js';\nimport { Mixer } from './components/Mixer.js';\nimport { FXRack } from './components/FXRack.js';\n\nexport class UIManager {\n  constructor(app) {\n    this.app = app;\n    this.audio = app.audioEngine;\n    this.components = {};\n    \n    // Core references\n    this.dom = {\n      header: document.getElementById('app-header'),\n      main: document.getElementById('app-main'),\n      loading: document.getElementById('loading-screen'),\n    };\n  }\n\n  async init() {\n    console.log('[UIManager] Initializing Sovereign Interface...');\n    \n    // 1. Initialize Components\n    this.components.transport = new Transport(this.app);\n    this.components.mixer = new Mixer(this.app);\n    this.components.fxRack = new FXRack(this.app);\n\n    // 2. Setup Global Listeners\n    this._setupGlobalKeys();\n    this._setupDragDrop();\n\n    // 3. Initialize Sub-components\n    await this.components.transport.init();\n    await this.components.mixer.init();\n    await this.components.fxRack.init();\n\n    // 4. Initial Render\n    this.update();\n    \n    console.log('[UIManager] Interface Ready.');\n  }\n\n  // Called 60fps from App animation loop\n  update(analysisData) {\n    // Delegate updates to components\n    if (this.components.transport) this.components.transport.update();\n    if (this.components.mixer) this.components.mixer.update(analysisData);\n    // FX Rack might need updates if we visualize parameters\n  }\n\n  // ‚îÄ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  \n  _setupGlobalKeys() {\n    document.addEventListener('keydown', (e) => {\n      // Global shortcuts (Space for play/pause handling is in Transport)\n      if (e.code === 'Escape') this.toggleShortcutsModal();\n    });\n  }\n\n  _setupDragDrop() {\n    // Global file drop for deck loading\n    const dropOverlay = document.getElementById('drop-overlay');\n    \n    document.addEventListener('dragover', (e) => {\n      e.preventDefault();\n      dropOverlay.classList.remove('hidden');\n    });\n\n    document.addEventListener('dragleave', (e) => {\n      if (e.target === dropOverlay) {\n        dropOverlay.classList.add('hidden');\n      }\n    });\n\n    document.addEventListener('drop', async (e) => {\n      e.preventDefault();\n      dropOverlay.classList.add('hidden');\n      \n      const files = Array.from(e.dataTransfer.files).filter(f => \n        f.type.startsWith('audio/')\n      );\n\n      if (files.length > 0) {\n        // Load first file to active or empty deck\n        // Logic handled by App or delegated here? \n        // For now, let's notify App to handle it\n        this.app.handleFileDrop(files);\n      }\n    });\n  }\n\n  toggleLoading(show) {\n    if (show) {\n      this.dom.loading.classList.remove('loaded');\n      this.dom.loading.style.visibility = 'visible';\n    } else {\n      this.dom.loading.classList.add('loaded');\n      setTimeout(() => {\n        this.dom.loading.style.visibility = 'hidden';\n      }, 800);\n    }\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   SamplePadEngine ‚Äî Built-in Drum Synthesis\n   Sovereign percussive synthesis module.\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nexport class SamplePadEngine {\n  constructor(audioCtx, destination) {\n    this.ctx = audioCtx;\n    this.dest = destination;\n    this.samples = {};\n    this.generateDrumSamples();\n  }\n\n  generateDrumSamples() {\n    this.samples = {\n      1: () => this._kick(),\n      2: () => this._snare(),\n      3: () => this._hihat(),\n      4: () => this._clap(),\n      5: () => this._tom(),\n      6: () => this._ride(),\n      7: () => this._fx1(),\n      8: () => this._fx2(),\n    };\n  }\n\n  trigger(padId) { \n    if (this.samples[padId]) this.samples[padId](); \n  }\n  \n  // Synthesis methods\n  _kick() { this._tone(150, 0.01, 0.5); }\n  _tom() { this._tone(200, 50, 0.3); }\n  _fx1() { this._tone(4000, 100, 0.3, 'sawtooth'); }\n  _fx2() { this._tone(200, 2000, 0.5, 'sine', 'linear'); }\n  \n  _tone(freqStart, freqEnd, dur, type='sine', ramp='exponential') {\n    const osc = this.ctx.createOscillator();\n    const gain = this.ctx.createGain();\n    osc.type = type;\n    \n    osc.frequency.setValueAtTime(freqStart, this.ctx.currentTime);\n    if (ramp === 'exponential') {\n      osc.frequency.exponentialRampToValueAtTime(freqEnd, this.ctx.currentTime + dur);\n    } else {\n      osc.frequency.linearRampToValueAtTime(freqEnd, this.ctx.currentTime + dur);\n    }\n    \n    gain.gain.setValueAtTime(1, this.ctx.currentTime);\n    gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + dur);\n    \n    osc.connect(gain); \n    gain.connect(this.dest);\n    \n    osc.start(); \n    osc.stop(this.ctx.currentTime + dur);\n  }\n\n  _snare() { \n    this._noise(0.2, 1000, 'highpass'); \n    this._tone(200, 0.01, 0.1, 'triangle'); \n  }\n  \n  _hihat() { \n    this._noise(0.05, 7000, 'highpass'); \n  }\n  \n  _ride() { \n    this._noise(0.4, 10000, 'bandpass'); \n  }\n  \n  _noise(dur, freq, type) {\n    const noise = this.ctx.createBufferSource();\n    const buf = this.ctx.createBuffer(1, this.ctx.sampleRate * dur, this.ctx.sampleRate);\n    const d = buf.getChannelData(0);\n    for (let i = 0; i < d.length; i++) d[i] = Math.random() * 2 - 1;\n    \n    noise.buffer = buf;\n    \n    const fil = this.ctx.createBiquadFilter(); \n    fil.type = type; \n    fil.frequency.value = freq;\n    \n    const gain = this.ctx.createGain();\n    gain.gain.setValueAtTime(0.5, this.ctx.currentTime);\n    gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + dur);\n    \n    noise.connect(fil); \n    fil.connect(gain); \n    gain.connect(this.dest);\n    \n    noise.start();\n  }\n  \n  _clap() {\n     // Multi-burst\n     for(let i=0; i<3; i++) {\n         setTimeout(() => this._noise(0.02, 2500, 'bandpass'), i*10);\n     }\n  }\n}\n","/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n   EUSKAI MIXER ‚Äî Sovereign Orchestrator\n   Core Logic (Audio, State) only. UI delegated.\n   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */\n\nimport { AudioEngine } from './audio/audio-engine.js';\nimport { WaveformRenderer } from './audio/waveform-renderer.js';\nimport { FXEngine } from './fx/fx-engine.js';\nimport { MasterChain } from './audio/master-chain.js';\nimport { Timeline } from './timeline/timeline.js';\nimport { Visualizer } from './viz/visualizer.js';\nimport { Exporter } from './export/exporter.js';\nimport { UIManager } from './ui/UIManager.js';\nimport { SamplePadEngine } from './audio/sample-engine.js';\n\n// SamplePadEngine extracted to src/audio/sample-engine.js\n\n// ‚îÄ‚îÄ‚îÄ SPECTRUM ANALYZER (Visual Helper) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nclass SpectrumAnalyzer {\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d');\n    this._resizeObserver = new ResizeObserver(() => this._resize());\n    if(canvas) this._resizeObserver.observe(canvas);\n  }\n  _resize() {\n    if(!this.canvas) return;\n    const rect = this.canvas.getBoundingClientRect();\n    const dpr = window.devicePixelRatio || 1;\n    this.canvas.width = rect.width * dpr;\n    this.canvas.height = rect.height * dpr;\n    this.ctx.scale(dpr, dpr);\n    this.width = rect.width;\n    this.height = rect.height;\n  }\n  draw(frequencyData) {\n    if (!this.canvas || !frequencyData) return;\n    const { ctx, width, height } = this;\n    ctx.clearRect(0, 0, width, height);\n    const barCount = Math.min(frequencyData.length, 64); // Reduced for cleaner look\n    const barWidth = width / barCount;\n    for (let i = 0; i < barCount; i++) {\n        const val = frequencyData[i] / 255;\n        const h = val * height;\n        ctx.fillStyle = `hsla(${120 + i*2}, 100%, 50%, 0.8)`; // Cyber Lime gradient\n        ctx.fillRect(i * barWidth, height - h, barWidth - 2, h);\n    }\n  }\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// MAIN APP\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nclass MixcraftApp {\n  constructor() {\n    // 1. Core Engine\n    this.audioEngine = new AudioEngine();\n    \n    // 2. State\n    this.isInitialized = false;\n    this.isPlaying = false;\n    this.nextDeck = 'A';\n    this.hotCues = { A: {}, B: {} };\n    \n    // 3. Components (Lazy Init)\n    this.ui = new UIManager(this);\n    this.exporter = new Exporter();\n    \n    // 4. Visuals\n    this.visualizer = null;\n    this.spectrum = null;\n    this.waveforms = { A: null, B: null };\n    \n    // 5. FX & Tools\n    this.fxEngine = null; // Init after AudioContext\n    this.masterChain = null;\n    this.samplePads = null;\n    this.timeline = null;\n\n    // Boot\n    this._boot();\n  }\n\n  async _boot() {\n    console.log('[EuskAI mixer] Booting...');\n    \n    // Initialize UI first (it handles DOM event binding)\n    await this.ui.init();\n    \n    // Setup Visualizers that need DOM\n    this._setupVisualizers();\n    \n    // Setup Drag & Drop Handlers (via UIManager or internal helper)\n    // The UIManager handles the global drop zone, but we need to handle specific logic\n\n    // Start Loop\n    this._startAnimationLoop();\n    \n    // Load Demo Tracks (Robe Remix Stems)\n    await this._loadDemoTracks();\n\n    // Done\n    this.ui.toggleLoading(false);\n    \n    console.log(\n      '%c‚óà EUSKAI MIXER V1 ‚óà %cLiquid Glass Engine Ready',\n      'color: #CCFF00; font-weight: bold; font-size: 16px; background: #000; padding: 4px;',\n      'color: #7B2FFF; background: #000; padding: 4px;'\n    );\n  }\n\n  async _loadDemoTracks() {\n    console.log('[Demo] Loading Robe Remix Stems...');\n    // Simulating file load from path - in a real browser app this requires\n    // fetching the file as a Blob/File object.\n    const demoTracks = [\n      { id: 'A', path: '/sound_design/robe_remix/loop_riser.wav', name: 'Robe Riser (Loop)' },\n      { id: 'B', path: '/sound_design/robe_remix/memory_glitch.wav', name: 'Memory Glitch' }\n    ];\n\n    for (const track of demoTracks) {\n      try {\n        const response = await fetch(track.path);\n        if (!response.ok) throw new Error(`Failed to fetch ${track.path}`);\n        const blob = await response.blob();\n        const file = new File([blob], track.name, { type: 'audio/wav' });\n        await this.loadTrack(track.id, file);\n      } catch (err) {\n        console.warn(`[Demo] Could not load track ${track.name}:`, err);\n      }\n    }\n  }\n\n  // ‚îÄ‚îÄ‚îÄ INITIALIZATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  async _ensureAudio() {\n    if (!this.isInitialized) {\n      await this.audioEngine.init();\n      const ctx = this.audioEngine.ctx;\n      \n      // Initialize sub-engines that need Context\n      this.fxEngine = new FXEngine(ctx);\n      this.audioEngine.fxEngine = this.fxEngine; // Link back if needed\n      \n      this.masterChain = new MasterChain(ctx);\n      this.audioEngine.masterChain = this.masterChain;\n      \n      this.samplePads = new SamplePadEngine(ctx, this.audioEngine.masterGain);\n      // generateDrumSamples is called in constructor now\n      \n      // Wire Master Chain: MasterGain -> MasterChain -> Destination\n      this.audioEngine.masterGain.disconnect();\n      this.audioEngine.masterGain.connect(this.masterChain.input);\n      this.masterChain.output.connect(ctx.destination);\n      \n      this.isInitialized = true;\n    }\n  }\n\n  _setupVisualizers() {\n    // Waveforms\n    const wavA = document.getElementById('waveform-a');\n    const wavB = document.getElementById('waveform-b');\n    if(wavA) this.waveforms.A = new WaveformRenderer(wavA, { waveColor: '#CCFF00' });\n    if(wavB) this.waveforms.B = new WaveformRenderer(wavB, { waveColor: '#7B2FFF' });\n\n    // Main Viz\n    const vizCanvas = document.getElementById('visualizer-canvas');\n    if(vizCanvas) this.visualizer = new Visualizer(vizCanvas);\n    \n    // Spectrum\n    const specCanvas = document.getElementById('spectrum-canvas');\n    if(specCanvas) this.spectrum = new SpectrumAnalyzer(specCanvas);\n    \n    // Timeline\n     const tlContainer = document.getElementById('timeline-container');\n     const tlRuler = document.getElementById('timeline-ruler');\n     if (tlContainer) this.timeline = new Timeline(tlContainer, tlRuler);\n  }\n\n  // ‚îÄ‚îÄ‚îÄ TRANSPORT LOGIC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  async togglePlayback() {\n    await this._ensureAudio();\n    \n    if (this.audioEngine.isPlaying) {\n      this.audioEngine.pause();\n      this.visualizer?.stop();\n    } else {\n      this.audioEngine.play();\n      this.visualizer?.start();\n    }\n    // UIManager updates UI based on engine state in update loop\n  }\n\n  async toggleRecording() {\n    // Basic implementation for now\n    console.log('[App] Recording toggle requested');\n  }\n\n  // ‚îÄ‚îÄ‚îÄ FILE HANDLING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  async handleFileDrop(files) {\n    // Logic called by UIManager\n    for (const file of files) {\n       await this.loadTrack(this.nextDeck, file);\n       this.nextDeck = this.nextDeck === 'A' ? 'B' : 'A';\n    }\n  }\n\n  async loadTrack(deckId, file) {\n    await this._ensureAudio();\n    try {\n      // Clean this up: UIManager should show \"Loading...\"\n      // For now, accessed via DOM directly or events? \n      // Ideally App emits events, but direct DOM access for MVP is faster.\n      const deck = await this.audioEngine.loadTrack(deckId, file);\n      \n      // Update Waveform\n      this.waveforms[deckId]?.setWaveformData(deck.waveformData);\n      \n      // Add to Timeline\n      this.timeline?.addTrack(deck);\n      \n      // Notification\n      console.log(`Loaded ${deck.name} to Deck ${deckId}`);\n      \n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  // ‚îÄ‚îÄ‚îÄ LOOP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n  _startAnimationLoop() {\n    const loop = () => {\n      // 1. Get audio data\n      let freqData = null;\n      let timeData = null;\n      let analysis = null;\n\n      if (this.isInitialized && this.audioEngine.isPlaying) {\n         freqData = this.audioEngine.getAnalyserData();\n         timeData = this.audioEngine.getAnalyserTimeData();\n         analysis = this.masterChain?.getAnalysis(); // RMS, LUFS\n      }\n      \n      // 2. Update Visuals\n      if (this.visualizer && this.audioEngine.isPlaying) {\n         this.visualizer.draw(freqData, timeData);\n      }\n      if (this.spectrum) {\n         this.spectrum.draw(freqData);\n      }\n      \n      // 3. Update UI (Meters, Playhead, Time)\n      this.ui.update(analysis);\n      \n      requestAnimationFrame(loop);\n    };\n    loop();\n  }\n}\n\n// Start\nwindow.mixcraft = new MixcraftApp();\n"],"names":["CAMELOT_WHEEL","NOTE_NAMES","MAJOR_PROFILE","MINOR_PROFILE","AudioEngine","id","freq","type","eq","a","deckId","file","deck","arrayBuffer","keyResult","buffer","samples","channel","blockSize","peaks","i","max","start","j","abs","sampleRate","downFactor","downLength","downsampled","windowSize","onsets","energy","prevEnergy","effectiveRate","minLag","maxLag","bestCorr","bestLag","lag","corr","normalizer","normalizedBpm","centerStart","fftSize","segment","chroma","bin","noteNum","noteIndex","maxChroma","bestKey","bestMode","shift","corrMajor","corrMinor","idx","camelotInfo","camelot","time","wasPlaying","maxDur","value","band","eqMap","volA","volB","data","camelot1","camelot2","num1","letter1","num2","letter2","diff","WaveformRenderer","canvas","options","rect","dpr","progress","ctx","width","height","waveformData","playProgress","colors","centerY","barWidth","playX","x","amplitude","bw","e","_a","FXEngine","audioCtx","reverb","decay","rate","length","ch","diffusion","delay","filter","active","dist","amount","curve","deg","phaser","prevNode","ap","sourceNode","destNode","MasterChain","params","t","bandDefs","def","index","b","irBuffer","err","noise","envelope","harmonics","hfRolloff","earlyRef","resonance","harmonic2","harmonic3","dB","binCount","sumSquares","rms","rmsDb","peak","peakDb","crestFactor","crestDb","weightedSum","totalEnergy","magnitude","frequency","centroid","rolloffThreshold","cumulativeEnergy","rolloff","geometricMean","arithmeticMean","validBins","flatness","lufsEstimate","bandCount","threshold","attenuation","attackMs","releaseMs","nyquist","bands","avgEnergy","currentGains","attack","release","binIndex","startBin","endBin","bandEnergy","alpha","ratio","targetGain","currentGain","timeConstant","enable","lastNode","Timeline","container","rulerCanvas","track","trackData","lastTrack","effectivePxPerSec","trackEl","label","content","region","regionName","miniCanvas","color","step","element","pxPerSec","isDragging","startX","originalLeft","dx","newLeft","maxEnd","end","totalWidth","interval","sec","min","s","level","currentTime","sorted","remaining","last","bestIdx","bestScore","candidate","harmonicScore","bpmDiff","bpmScore","totalScore","prev","Visualizer","size","getFreqData","getTimeData","freqData","timeData","_b","centerX","radius","bassEnergy","glowRadius","gradient","bars","angleStep","barLength","angle","x1","y1","x2","y2","hue","lightness","oscRadius","r","y","breathRadius","centerGrad","cx","cy","pulse","grad","p","Exporter","audioEngine","timeline","onProgress","totalDuration","channels","frameCount","offlineCtx","source","gain","fadeTime","startTime","endTime","renderedBuffer","wavBlob","numOfChan","bufferArr","view","offset","sample","string","tracks","lines","blob","filename","url","text","Transport","app","minutes","seconds","ms","Mixer","v","cf","val","selector","callback","el","analysisData","lufsDisplay","reduction","thresh","reductionDb","meter","fill","pct","FXRack","btn","idSuffix","UIManager","dropOverlay","files","f","show","SamplePadEngine","destination","padId","freqStart","freqEnd","dur","ramp","osc","buf","d","fil","SpectrumAnalyzer","frequencyData","barCount","h","MixcraftApp","demoTracks","response","wavA","wavB","vizCanvas","specCanvas","tlContainer","tlRuler","loop","analysis"],"mappings":"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"}
./mixcraft/src/ui/UIManager.js:    console.log('[UIManager] Initializing Sovereign Interface...');
./mixcraft/src/ui/UIManager.js:    console.log('[UIManager] Interface Ready.');
./mixcraft/src/app.js:    console.log('[EuskAI mixer] Booting...');
./mixcraft/src/app.js:    console.log(
./mixcraft/src/app.js:    console.log('[Demo] Loading Robe Remix Stems...');
./mixcraft/src/app.js:    console.log('[App] Recording toggle requested');
./mixcraft/src/app.js:      console.log(`Loaded ${deck.name} to Deck ${deckId}`);
./main.js:      console.log('‚úÖ [APOTHEOSIS] System Soul active.');
./run_swarm_audit.cjs:  console.log('üöÄ Launching Fractal Swarm (40 Agents) for Code Review...');
./run_swarm_audit.cjs:    console.log('üîç Target: /Users/borjafernandezangulo/game/naroa-2026');
./run_swarm_audit.cjs:    console.log('\n‚úÖ Mission Complete!');
./run_swarm_audit.cjs:    console.log('üìÑ Report generated at:', report.filePath);
./run_swarm_audit.cjs:        console.log('\n--- REPORT SUMMARY ---\n');
./run_swarm_audit.cjs:        console.log(fs.readFileSync(report.filePath, 'utf8').substring(0, 2000) + '...');
./scripts/convert_images.cjs:    .then(info => console.log(`Converted ${file} to ${output}`))
./scripts/optimize-regular-images.cjs:      console.log(`‚è≠Ô∏è  SKIP (preserve): ${filePath}`);
./scripts/optimize-regular-images.cjs:      console.log(`‚è≠Ô∏è  SKIP (already small): ${filePath}`);
./scripts/optimize-regular-images.cjs:      console.log(`‚úÖ ${inputPath} ‚Üí ${(newSize / 1024).toFixed(0)}KB (saved ${saved}%)`);
./scripts/optimize-regular-images.cjs:      console.log(`‚è≠Ô∏è  SKIP (no improvement): ${inputPath}`);
./scripts/optimize-regular-images.cjs:  console.log('üîç Finding images to optimize...\n');
./scripts/optimize-regular-images.cjs:  console.log(`üì¶ Found ${allFiles.length} total images\n`);
./scripts/optimize-regular-images.cjs:  console.log(`\nüéØ ${toOptimize.length} images to optimize\n`);
./scripts/optimize-regular-images.cjs:  console.log(`\n‚úÖ Optimization complete! Processed ${optimized}/${toOptimize.length} images`);
./scripts/convert_cursor.js:    console.log(`Converted ${input} to ${output}`);
./scripts/reconcile_public.cjs:                    console.log(`[MISSING IN ROOT] Copying ${p} -> ${r}`);
./scripts/reconcile_public.cjs:                        console.log(`[NEWER IN PUBLIC] Updating ${r} with ${p}`);
./scripts/reconcile_public.cjs:console.log('Reconciliation complete.');
./scripts/cleanup_pngs.cjs:console.log(`Deleted ${deletedCount} redundant PNG files.`);
./scripts/optimize-assets.js:    console.log(`üñºÔ∏è Procesando ${files.length} im√°genes...`);
./scripts/optimize-assets.js:    console.log('‚úÖ Optimizaci√≥n completa');
./scripts/run_swarm_ui.cjs:  console.log('üöÄ Launching Fractal Swarm (40 Agents) for UI Upgrade...');
./scripts/run_swarm_ui.cjs:    console.log('\n‚úÖ Mission Complete!');
./scripts/run_swarm_ui.cjs:    console.log('üìÑ Report generated at:', report.filePath);
./scripts/run_swarm_ui.cjs:        console.log('\n--- REPORT SUMMARY ---\n');
./scripts/run_swarm_ui.cjs:        console.log(fs.readFileSync(report.filePath, 'utf8').substring(0, 3000));
./scripts/local-api.js:  console.log(`üîÆ Local API Server running at http://localhost:${PORT}`);
./scripts/merge_catalog.cjs:console.log(`Successfully populated database.json with ${finalDb.length} artworks`);
./scripts/run_swarm_audit.cjs:  console.log('üöÄ Launching Fractal Swarm (40 Agents) for Code Review...');
./scripts/run_swarm_audit.cjs:    console.log('üîç Target: /Users/borjafernandezangulo/game/naroa-2026');
./scripts/run_swarm_audit.cjs:    console.log('\n‚úÖ Mission Complete!');
./scripts/run_swarm_audit.cjs:    console.log('üìÑ Report generated at:', report.filePath);
./scripts/run_swarm_audit.cjs:        console.log('\n--- REPORT SUMMARY ---\n');
./scripts/run_swarm_audit.cjs:        console.log(fs.readFileSync(report.filePath, 'utf8').substring(0, 2000) + '...');
./scripts/vision_alt_generator.mjs:  console.log('üëÅÔ∏è  VISION-FOR-ALT: Sovereign Protocol Initiated...');
./scripts/vision_alt_generator.mjs:  console.log(`üìÇ Loaded ${artworks.length} artworks.`);
./scripts/vision_alt_generator.mjs:        // console.log(`‚è≠Ô∏è  Skipping ${artwork.id} (Existing Alt: "${artwork.altText.substring(0, 20)}...")`);
./scripts/vision_alt_generator.mjs:    console.log(`üé® Processing: ${artwork.id}...`);
./scripts/vision_alt_generator.mjs:      console.log(`   ‚ú® Generated: "${text}"`);
./scripts/vision_alt_generator.mjs:        console.log('üíæ Partial save.');
./scripts/vision_alt_generator.mjs:        console.log('‚è≥ Quota hit. Sleeping for 60s...');
./scripts/vision_alt_generator.mjs:  console.log(`\n‚úÖ MISSION COMPLETE. Updated ${updatedCount} artworks with Sovereign Alt Text.`);
./scripts/maintenance/generate-web-images.js:  console.log('üöÄ Generating Web-Optimized + Blur Placeholder Images...\n');
./scripts/maintenance/generate-web-images.js:      console.log(`  Using HQ fallback for ${name}`);
./scripts/maintenance/generate-web-images.js:  console.log('\n‚úÖ All done!');
./scripts/maintenance/generate-web-images.js:  console.log(`  üì∑ [${name}] Generating web version...`);
./scripts/maintenance/generate-web-images.js:  console.log(`     ‚úÖ web-${name}.webp ‚Üí ${webSize}KB`);
./scripts/maintenance/generate-web-images.js:  console.log(`  üå´Ô∏è  [${name}] Generating blur placeholder...`);
./scripts/maintenance/generate-web-images.js:  console.log(`     ‚úÖ blur-${name}.webp ‚Üí ${blurSize}KB`);
./scripts/maintenance/merge-seo-data.cjs:      console.log(`‚ûï Added new artwork with taxonomy: ${enrichedItem.title} (${enrichedItem.category})`);
./scripts/maintenance/merge-seo-data.cjs:  console.log(`‚úÖ Merge Complete: ${updatedCount} updated, ${addedCount} added.`);
./scripts/maintenance/fix-images.cjs:    console.log('üîß Starting Image Path Repair...');
./scripts/maintenance/fix-images.cjs:            console.log(`‚úÖ Fixed ${artwork.id} -> ${validImage}`);
./scripts/maintenance/fix-images.cjs:        console.log(`üéâ Updated ${changes} artworks in metadata.`);
./scripts/maintenance/fix-images.cjs:        console.log('‚ú® No changes needed.');
./scripts/maintenance/optimize-hero.js:  console.log('üöÄ Starting Lossless Optimization for Hero Images...');
./scripts/maintenance/optimize-hero.js:      console.log(`Processing ${file} ...`);
./scripts/maintenance/optimize-hero.js:      console.log(`‚úÖ Optimized ${outputFilename}: ${originalSize.toFixed(2)}MB -> ${newSize.toFixed(2)}MB`);
./scripts/compress-web-images.mjs:      console.log(
./scripts/compress-web-images.mjs:  console.log(`\nüéØ Total: ${processed} images, saved ${(totalSaved / 1024 / 1024).toFixed(1)}MB`);
./scripts/convert_images_lossless.cjs:    .then(info => console.log(`Converted LOSSLESS ${file} to ${output}`))
./scripts/ipfs-upload.js:  console.log('üöÄ Starting IPFS Upload via Pinata...');
./scripts/ipfs-upload.js:    console.log(`‚úÖ Authenticated: ${auth.message}`);
./scripts/ipfs-upload.js:  console.log(`üìÇ Found ${files.length} .webp images to upload`);
./scripts/ipfs-upload.js:      console.log(`üìò Loaded existing manifest with ${Object.keys(manifest.artworks).length} entries`);
./scripts/ipfs-upload.js:      // console.log(`‚è≠Ô∏è  Skipping ${id} (already pinned)`);
./scripts/ipfs-upload.js:      console.log(`üì§ Uploading ${file}...`);
./scripts/ipfs-upload.js:      console.log(`‚úÖ Pinned: ${result.IpfsHash}`);
./scripts/ipfs-upload.js:  console.log(`\nüéâ Done! ${newUploads} new files uploaded.`);
./scripts/ipfs-upload.js:  console.log(`üìÑ Manifest saved to ${MANIFEST_PATH}`);
./mica-hero-standalone.html:        console.log('Micr√≥fono activado');
./mica-hero-standalone.html:    console.log('‚ú® MICA Hero System Initialized');
./api/chat.js:    console.log(`[MICA Brain] Using Provider: ${providerName}`);
./convert_images_lossless.cjs:    .then(info => console.log(`Converted LOSSLESS ${file} to ${output}`))
